% vim: set spelllang=fr foldmethod=marker:
\section{Déni de service}\label{ea:sec:dos}

\subsection{Différentes classifications}

outsider/insider attack
passive/active attack
mote-class/laptop-class attack

attaques sur protocoles de clustering

La sureté et la résilience des réseaux, traités en \ssref{ea:ssec:safety}, ne sont pas des problématiques de sécurité (car aucune attaque ne rentre en compte), mais il s'agit de problématiques assez proches de la disponibilité des réseaux.


\subsection{Différents types d'attaques}

\subsection{Différents mécanismes de protection}

Indeed there are many existing attacks able to compromise the good working of a \wsn.%ONDEMAND \cite{ZJ09}.
Several mechanisms have been proposed to detect it and to provide countermeasures\cite{SSS11}. %ONDEMAND ,SSF13}.
Many consist in the implementation of trust based mechanisms\cite{MC10,F-GRL07} with agents applying set of rules\cite{RKKK13} on traffic to attribute a trust value to each of the nodes in the network.
In particular, Lai and Chen\cite{LC08} proposed to elect control nodes to monitor the traffic in clustered networks and to detect and react to \dos attacks.



In a first attempt to bring load balancing to this solution, we propose in other papers\cite{GMT12,BMM13} to reiterate the election periodically.
Simulations show a better load repartition among the cluster, but at this time our focus was not on designing an energy efficient election process for the \cns.

%%%%%%%%%%%%%%%%%%%================================================
% Detecting Denial of Service Attacks in Sensor Networks
%\subsection{[LC08] -- Inchangé}

%\subsubsection{Ancienne version}
%A cluster-based intrusion detection system is proposed in
%\cite{LC08}.
%It prevents sensor networks from DoS attacks.
%This solution deploys a set of special nodes called ``guarding nodes'' (gNodes) which observe, analyze the network traffic and report DoS attacks to their cluster head if an abnormal event happens.
%In each cluster there are three types of nodes, gNode, cluster head and sensor node.
%Any kind of nodes may be compromised.
%In this study, the detection approach for diverse attack types and the actions taken after detection are explored for the different node types.

%\subsubsection{Version Camera-Ready}
In
\cite{LC08},
the authors propose a system detection based on static election of a set of special nodes called ``guarding nodes'' which analyze the network traffic.
When detecting abnormal traffic from a given node, ``guarding nodes'' identify it as a compromised node and they inform the cluster head of it.
In this study, the authors show the benefit of their method by presenting numerical analysis of detection rate but they don't consider the energy of the elected node which dies very quickly.


% ======== >>> §3 <<<
%\subsection{[SM10] -- Ajouté}

% An adaptive learning routing protocol for the prevention of DDoS attacks in wireless mesh networks
In
\cite{MKASF10},
\textit{Misra et al}. propose a revised version of the OLSR protocol.
This routing protocol called DLSR aims at detecting distributed denial of service (DDoS) attacks and at dropping malicious requests before they can saturate a server's capacity to answer.
To that end, the authors introduce two alert thresholds regarding this server's service capacity.
They also introduce the use of Learning Automata (LAs), automatic systems whose choice of next action depends on the result of its previous action.
There is no indication in their work about the overhead or the energy load resulting from the use of the DLSR protocol.

% An adaptive learning routing protocol for the prevention of DDoS attacks in wireless mesh networks
In~\cite{MKASF10}, a revised version of the OLSR protocol is proposed.
This routing protocol called DLSR aims at detecting distributed denial of service (DDoS) attacks and at dropping malicious requests before they can saturate a server's capacity to answer.
To that end, the authors introduce two alert thresholds regarding this server's service capacity.
The authors also use Learning Automata (LAs), automatic systems whose choice of next action depends on the result of its previous action.
There is no indication in their work about the overhead or the energy load resulting from the use of the DLSR protocol.


% ======== >>> §4 <<<
%\subsection{[HI09] -- Modifié}

%% Optimal Sensor Placement for Detection against Distributed Denial of Service Attacks
The best way to detect for sure a DoS attack in a WSN is simply to run a detection mechanism on each single sensor.
Of course, this solution is not feasible in a network with constraints.
Instead of fitting out each sensor with such mechanism, \textit{Islam et al}. propose in
\cite{INK09}
to resort to heuristics in order to set a few nodes equipped with detection systems at critical spots in the network topology.
This optimized placement enables distributed detection of DoS attacks as well as reducing costs and processing overheads, since the number of required detectors is minimized.
But those few selected nodes are likely to run out of battery power much faster than normal nodes.

%% OLD VERSION
%The running of a detection mechanism on every node in the network allows achieving a perfect detection against DoS attacks but it is not a feasible solution in a constrained network.
%In
%\cite{HI09},
%an optimized placement of detection nodes in a network for distributed detection of DoS attacks is proposed.
%In addition to placing detection nodes at critical points in a network, this proposition minimizes the number of these required nodes and therefore reduces the cost and processing overheads.

%% Optimal Sensor Placement for Detection against Distributed Denial of Service Attacks
The best way to detect for sure a DoS attack in a WSN is simply to run a detection mechanism on each single sensor.
Of course, this solution is not feasible in a network with constraints.
Instead of fitting out each sensor with such mechanism, it is proposed in~\cite{INK09} to resort to heuristics in order to set a few nodes equipped with detection systems at critical spots in the network topology.
This optimized placement enables distributed detection of DoS attacks as well as reducing costs and processing overheads, since the number of required detectors is minimized.
But those few selected nodes are likely to run out of battery power much faster than normal nodes.


% ======== >>> §1 <<<
% Denial of service attack-resistant flooding authentication in wireless sensor networks
%\subsection{[JS10] -- Inchangé}

\textit{Son et al}. propose in
\cite{JS10}
a novel broadcast authentication mechanism to cope with DoS attacks in sensor networks.
This scheme uses an asymmetric distribution of keys between sensor nodes and the BS, and uses the Bloom filter as an authenticator, which efficiently compresses multiple authentication information.
In this model, the BS or sink shares symmetric keys with each sensor node, and proves its knowledge of the information through multiple MAC values in its flooding messages.
When the sink floods the network with control messages it constructs a Bloom filter as an authenticator for the message.
When a sensor node receives a flooded control message, it generates their Bloom filter with its keys and in the same way the sink verifies message authentication.

% Denial of service attack-resistant flooding authentication in wireless sensor networks
A novel broadcast authentication mechanism can also be deployed so as to cope with DoS attacks in sensor networks such as in~\cite{SLS10}.
This scheme uses an asymmetric distribution of keys between sensor nodes and the BS, and uses the Bloom filter as an authenticator, which efficiently compresses multiple authentication information.
In this model, the BS or sink shares symmetric keys with each sensor node, and proves its knowledge of the information through multiple MAC values in its flooding messages.
When the sink floods the network with control messages it constructs a Bloom filter as an authenticator for the message.
When a sensor node receives a flooded control message, it generates their Bloom filter with its keys and in the same way the sink verifies message authentication.




Several mechanisms have been proposed to detect it and to provide countermeasures\cite{SSS11,RM11}.
Even restricted to the data link, media access control and network layers of the network, there are many different existing \DoS attacks.
Consequently, even more solutions have been proposed to counter them.
Various studies have been realized in the purpose of countering one specific kind of attack, sometimes on specific protocols, thus leading to the proposals of hardened versions of AODV\cite{DLA02} or DSR\cite{CT04} for instance.
Some researchers prefer to ensure that nodes are not physically withdrawn from the network to get modified\cite{Ho10}, considering any returning node as compromised (but not detecting nodes modified on site), or to verify by means of mobile agents that the binary code run by the nodes has not been modified\cite{HR13}, although this solution makes use of cryptography mechanisms and can limit the evolution of the network.

Many other systems, often more convenient to deploy, consist in the implementation of trust based mechanisms\cite{MC10,F-GRL07} with agents applying set of rules\cite{RKKK13} on traffic to attribute a trust value to each of the nodes in the network.
Each enforced rule is expected to protect the network against one kind of attacks: intruders are detected on breaking the rules.
We are particularly interested in the solution of Lai and Chen\cite{LC08} who proposed to elect control nodes to monitor the traffic in clustered networks so as to detect and react to \dos attacks.
In such a scheme, clustered networks are partitioned into clusters \via algorithms such as \leach\cite{HHT02} or VSR\cite{TV08}.





To deal with DoS attacks in wireless sensor networks, many research studies have been conducted: there are many existing attacks able to compromise the good working of a \wsn.
Even more mechanisms have been proposed to detect it and to provide countermeasures~\cite{SSS11}.
Many consist in the implementation of trust based mechanisms~\cite{MC10,F-GRL07} with agents applying set of rules~\cite{RKKK13} on traffic to attribute a trust value to each of the nodes in the network.
Below are outlined some notable proposals.

% ======== >>> §2 <<<
%\subsection{[JH10] -- Ajouté}

% Distributed Detection of Node Capture Attacks in Wireless Networks
Some works examine the possibility to detect the compromising of nodes as soon as an opponent physically withdraw them from the network.
In the method that \textit{Ho} develops in
\cite{Ho10},
each node keeps watching on the presence of its neighbors.
The Sequential Probability Radio Test (SPRT) is used to determinate a dynamic time threshold.
When a node appears to be missing for a period longer that this threshold, it is considered to be dead or captured by an attacker.
If this node is later redeployed in the network, it will immediately be considered as compromised without having a chance to be harmful.
Nothing is done, however, if an attacker manages to compromise the node without extracting the sensor from its environment.

% Distributed Detection of Node Capture Attacks in Wireless Networks
Some works examine the possibility to detect the compromising of nodes as soon as an opponent physically withdraw them from the network.
In the method that is developed in~\cite{Ho10}, each node keeps watching on the presence of its neighbors.
The Sequential Probability Radio Test (SPRT) is used to determinate a dynamic time threshold.
When a node appears to be missing for a period longer that this threshold, it is considered to be dead or captured by an attacker.
If this node is later redeployed in the network, it will immediately be considered as compromised without having a chance to be harmful.
Nothing is done, however, if an attacker manages to compromise the node without extracting the sensor from its environment.

%% Using mobile agents to recover from node and database compromise in path-based DoS attacks in wireless sensor network
In~\cite{LB09} is described a method to detect and to recover from Path-based DoS (PDoS) attacks in wireless sensor networks.
The authors consider WSNs whose aim is to collect data and to store it into small databases.
PDoS attacks may prevent legitimate communication, lead the sensors to battery exhaustion and corrupt the gathered data.
Thus the use of Mobile Agents (MAs) is introduced: they use hash function values, node IDs and traffic table to analyze the traffic and identify compromised sensors.
In this way the MAs are able to detect PDoS attacks with ease and efficiency, and to reply to the attack by proceeding to a recovery process.
There are three distinct recovery processes available, depending on the percentage of compromised nodes in the network.
Note that the authors use the assumption that MAs can not be compromised.

%% Detecting denial of service attacks in sensor networks
Much of our work relies on the work of Lai and Chen who proposed in~\cite{LC08} a system detection based on static election of a set of nodes called ``guarding nodes'' which analyze traffic in a clustered network.
When detecting abnormal traffic from a given node, ``guarding nodes'' ---~we call them \cns~--- identify it as a compromised node and inform the \ch of it.
On reception of reports from several distinct \cns (to prevent false denunciation from a compromised node), the \CH virtually excludes the suspicious node from the cluster.
The authors show the benefit of their method by presenting numerical analysis of detection rate.
Although the method is efficient for detecting rogue nodes, the authors do not give details of the election mechanism to choose the \cns.
Also, there is no mention in their study of renewing the election in time, which causes the appointed \cns to endorse a heavier energy consumption on a long period.






% ======== >>> §5 <<<
%\subsection{[MH07] -- Modifié}

%% Adaptive security design with malicious node detection in cluster-based sensor networks
%% OLD VERSION
%An adaptive security design (SecCBSN) to secure cluster-based communication in sensor networks, is proposed by \textit{Hsieh et al.} in
%\cite{MH07}.
%It consists of three modules, which can detect malicious nodes by providing secure communication and authentication protocols between nodes.
%In each cluster, a CH schedules transmission and monitors periods for its sensor nodes.
%The primary security module uses the TESLA certificate (TCert) to enable existing nodes to authenticate new incoming nodes, triggering the establishment of secure links and broadcast authentication between neighboring nodes.
%In SecCBSN, the intrusion detection module prevents against compromised nodes.
%It uses alarm return protocols, trust value evaluation, and the propagation of black and white lists of nodes.

%% Adaptive security design with malicious node detection in cluster-based sensor networks
Sensors authentication and DoS detection in clustered networks may be assumed by a single architecture.
SecCBSN is described in~\cite{HHC07}.
It is an adaptive security design intended to Secure Cluster-Based Communication in Sensor Networks.
Each node is equipped with a system that includes three modules.
One is involved in the cluster head election, and responsible for remembering the decision which were made.
Another module provides ciphered communication and secure authentication protocols between sensors.
It uses the TESLA certificate to enable deployed sensors to authenticate new incoming nodes.
It allows the creation of secure channels as well as broadcast authentication between neighboring sensors.
The last security module is responsible for the detection of compromised nodes.
When a node is suspected to harm the network, alarm protocols are used to warn the base station.
The use of trust value evaluation then enables the setting and the propagation of black and white lists of sensors.







% ======== >>> §2 <<<
%\subsection{[LB09] -- Modifié}

%% Using mobile agents to recover from node and database compromise in path-based DoS attacks in wireless sensor network
\textit{Li} and \textit{Batten} expose in
\cite{LB09}
their method to detect and to recover from Path-based DoS (PDoS) attacks in wireless sensor networks.
They consider WSNs whose aim is to collect data and to store it into small databases.
PDoS attacks may prevent legitimate communication, lead the sensors to battery exhaustion and corrupt the gathered data.
So the authors introduce the use of Mobile Agents (MAs), which use hash function values, node IDs and traffic table to analyze the traffic and identify compromised sensors.
Thus the MAs are able to detect PDoS attacks with ease and efficiency, and to reply to the attack by proceeding to a recovery process.
There are three distinct recovery processes available, depending on the percentage of compromised nodes in the network.
Note that the authors use the assumption that MAs can not be compromised.
%% OLD VERSION
%A new detection and recovery method for compromised nodes in Path-based DoS (PDoS) attacks in wireless sensor network is presented in \cite{LB09} by \textit{Li} and \textit{Batten}. In this paper, the authors consider WSNs designed to collect and to store data in which path-based attacks can be carried on both the sensor nodes and the database containing the collected data. The contribution of this paper is the use of mobile agents (MAs) for the attack detection and the recovery process. The MAs detect PDoS attacks easily and efficiently. The solution is based on the use of hash function values, node IDs and traffic tables. By analyzing the traffic, the MA can detect the abnormal traffic and can designate the compromised nodes.


% ======== >>> §2 <<<
%\subsection{[LO07] -- Modifié}
%% OLD VERSION
%Hierarchical sensor networks where clusters are formed dynamically and periodically using the LEACH algorithm, allow to distribute the energy load among sensor nodes.
%The problem of adding security to this type of network is raised by \textit{Oliveira et al}
%\cite{LO07}
%who propose SecLEACH which is a revised version of LEACH.
%It applies random key pre-distribution and $\mu$TESLA.
%They can be used both to secure communications in a hierarchical network with dynamic cluster establishment.

%% SecLEACH -- On the security of clustered sensor networks
A sensor network may be recursively and periodically reclustered with an algorithm such as \leach, as in our proposal.
The resulting hierarchically clustered network often presents a good ability for distributing the energy consumption among the sensor nodes.
But security concerns (other than DoS) also apply to those networks.
In~\cite{OFVWBDL07}, the authors propose to add security mechanisms \via a revised version of \leach protocol.
\textit{SecLEACH}\ uses random key pre-distribution as well as $\mu$TESLA (authenticated broadcast) so as to protect communications.
But the authors do not mention any mechanism to fight DoS attacks.





Denial of service attacks embraces many different attacks, which can target all layers of the network~\cite{VS10}.
Jamming the radio frequencies as well as disturbing the routing protocols are just a few examples of ways to harm the network.
In reaction to these, a number of solutions have been proposed~\cite{SSS11}.

As stated in the introduction, we focus in this paper on inside attackers attempting to bend the MAC protocol parameters to their needs, be it to achieve better performances for themselves (\emph{greedy} attacks) or to generally harm the network (\emph{jamming} attacks or sleep deprivation).
To detect such attackers, many solutions rely on trust models~\cite{MC10}.
We base our own work on Lai's and Chen's approach~\cite{LC08}, which consists in assigning monitoring nodes in the network.
Those monitoring nodes, also called \cns in this article, apply a set of rules~\cite{RKKK13} to overheard traffic so as to detect misbehaving nodes.
On multiple rule breaks, they report the suspicious node to the \ch.
To prevent false positive detection, the \CH waits for several reports about a given node before considering it as compromised.
After that, it virtually excludes the misbehaving node from the cluster by broadcasting a warning to all sensors.
We have observed in previous studies that renewing periodically the selection process of those monitoring nodes (\cns) helps saving energy in the network~\cite{BMM13}, and we have tried ever since to find an optimal selection algorithm to obtain a good equilibrium between security, attack detection and energy preservation~\cite{MMB14}.
