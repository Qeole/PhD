% vim: set spelllang=fr foldmethod=marker:
\section{Déni de service}\label{ea:sec:dos}
%{{{1
%{{{2

Une attaque dite de « déni de service » menée dans un réseau informatique est une attaque réalisée dans le but de nuire au fonctionnement normal de ce réseau.
Il existe de très nombreuses façons de procéder, et on recense par conséquent une multitude d'attaques par déni de service existantes.
L'état de l'art dans ce domaine (et à propos de la sécurité en général, par ailleurs) a ceci de particulier qu'il comporte deux points de vue: celui de l'attaquant et celui du « défenseur ».
Il est indispensable de pouvoir définir le modèle d'une attaque pour pouvoir proposer des contre-mesures adéquates.
Et de façon plus ou moins réciproque, les mécanismes de protection mis en place au fil du temps poussent les attaquants (ou les chercheurs) à développer de nouvelles attaques pour les contourner.

Les réseaux de capteurs se retrouvent malheureusement très exposés aux attaques de déni de service~\cite{RM11}, du fait de:
\begin{itemize}
    \item leurs ressources extrêmement limitées, et principalement en termes d'énergie;
    \item leurs faibles capacités, qui peuvent introduire des délais (latence dans les communications ou délai de traitement)
    \item leur exposition aux attaques physiques;
    \item la faible fiabilité du médium de transmission, en termes de confidentialité ou de collisions
    \item leur gestion réalisée à distance;
    \item l'absence d'une gestion centralisée (et l'impossibilité de connaitre avec précision le statut des autres nœuds);
\end{itemize}

Dans cette section nous présenterons d'abord les principales attaques répertoriées dans les réseaux de capteurs, puis nous aborderons les mécanismes proposés en réponse dans la littérature.
Auparavant, nous allons voir qu'il existe plusieurs façons de classer ces attaques.
%2}}}
%1}}}

\subsection{Différentes classifications}
%{{{1

\subsubsection{Selon l'objectif recherché}
%{{{2
Une première façon de classer les attaques est de considérer l'objectif de l'attaquant.
Les buts principaux de ces attaques sont:
\begin{itemize}
    \item l'accaparement de ressources pour les besoins propres de l'attaquant, au détriment des autres agents du réseau (par exemple, monopolisation du canal de transmission pour l'envoi des données de l'attaquant exclusivement). Il s'agit de comportements « cupides » (\textit{greedy} en anglais);
    \item la réduction, voir l'annihilation de la capacité du réseau à assurer correctement les services pour lequel il a été déployé, afin de nuire aux exploitants de ce réseau. Cette nuisance peut s'exprimer par des pertes financières, par exemple lorsqu'une telle attaque est menée sur Internet contre un site de commerce en ligne; dans le cas des réseaux de capteurs sans fils, et notamment lorsqu'ils sont utilisés dans un cadre militaire, l'exploitant d'un réseau peut alors se voir priver de l'accès aux informations stratégiques que devaient récolter les capteurs. On parle le plus souvent d'attaques de type \textit{jamming} en anglais, qui se traduit selon le cas par « brouillage », « encombrement », mais d'autres attaques reposant sur la privation de sommeil des capteurs, ou bien leur destruction physique, peuvent aussi être réalisées dans cet objectif;
    \item plus rarement, l'induction en erreur de l'exploitant du réseau de capteurs. Pour ceci l'attaquant cherche à fausser les résultats collectés (changement d'environnement des capteurs) ou transmis (altération du contenu ou du volume de données transmises).
\end{itemize}
%2}}}

\subsubsection{Selon la situation de l'attaquant}
%{{{2
On distingue également les attaques selon la provenance de l'attaquant, à savoir s'il fait partie du réseau, et mène par exemple une attaque sur le protocole de routage employé, ou bien s'il agit depuis l'extérieur du réseau, depuis une machine qui n'est pas reconnue comme faisant partie du réseau de capteurs.
Ce deuxième cas peut être illustré par un attaquant qui chercherait à brouiller de manière globale toutes les fréquences radio utilisées par les capteurs pour communiquer.

Un attaquant extérieur n'a pas forcément connaissance de la façon dont fonctionne le réseau (architecture, protocoles employés, mesure de détection mises en place).
Il peut mener une attaque sans ces informations (cas du brouillage des fréquences par exemple), ou bien justement chercher à s'introduire dans le réseau.
Cette intrusion peut être réalisée par l'attaquant soit en faisant accepter l'un de ses appareils propre aux autres agents du réseau, soit en compromettant l'un des agents jusqu'alors légitime dans le réseau.
Une fois l'accès interne obtenu, il devient généralement beaucoup plus facile d'accéder à des informations sur le fonctionnement du réseau.
L'attaquant, en fonction des mesures mises en place, devient aussi susceptibles d'être détecté et exclu du réseau.
Les attaques menées depuis l'intérieur jouent souvent sur les paramètres des protocoles employés, et sont souvent plus « subtiles », plus délicates à détecter et identifier pour l'opérateur du réseau si aucune méthode de détection d'intrusion n'a été mise en place.
%2}}}

\subsubsection{Selon les capacités de l'attaquant}
%{{{2
On peut encore distinguer les attaques selon la puissance dont dispose l'attaquant, que ce soit en terme de calcul, d'émission électromagnétiques, ou bien d'alimentation en énergie.
Un attaquant peut n'avoir à disposition qu'un capteur normal (\textit{mote-class attacks} en anglais), qu'il lui appartienne ou bien qu'il ait été compromis parmi les capteurs déployés à l'origine.
Il se retrouve dans ce cas avec des machines similaires aux appareils attaqués, mais n'a pas besoin de rester sur place et peut mener des attaques sur la durée.
Il peut également être équipé d'un ordinateur plus puissant (\textit{laptop-class attacks}), voir de matériel militaire spécialisé.
Dans ce cas, il est plus aisé de déployer de la puissance (puisque l'attaquant peut s'affranchir des limites imposées par les batteries des capteurs) et par exemple de brouiller en continu toute une plage de fréquence.
Il faut néanmoins que le matériel utilisé reste déployé le temps de mener l'attaque, ce qui peut s'avérer couteux sur la durée.
%2}}}

\subsubsection{Attaques actives, passives}
%{{{2
Cette méthode de classement ne s'applique pas ici.
Les attaques dites « passives » n'interfèrent pas avec le fonctionnement normal du réseau: il peut s'agir par exemple d'écoute clandestine en vue de collecter des données (atteinte à la confidentialité des communications), mais par définition les attaques de déni de service sont des attaques dites « actives », au cours desquelles l'attaquant introduit de nouveaux comportement dans le réseau.
%2}}}

\subsubsection{Selon le paradigme considéré}\label{ea:sss:paradigm}
%{{{2
Nous abordons à présent des méthodes effectives de classement, qui permettent de catégoriser plus précisément les attaques (plutôt que d'établir une simple dissociation des catégories sur un nombre restreint de critères).

Certaines études se penchent sur une classe d'opérations réalisées par les réseaux de capteurs, et répertorient les attaques et les contre-mesures qui s'appliquent à cette classe~\cite{JPD06,OX09}.
Les paradigmes suivants peuvent être considérés:
\begin{itemize}
    \item la collecte et la transmission simples des données (paradigme qui se concentre sur une collecte simple et un envoi direct à la station de base, sans traitement, sans routage dans le réseau);
    \item la transmission des données d'un point à un autre du réseau (\cad tout ce qui touche au routage des paquets dans le réseau, donc en faisant intervenir la retransmission des paquets par plusieurs nœuds intermédiaires);
    \item la réception et le traitement de commandes (dans le cas où les nœuds sont susceptibles de communiquer entre eux et de s'échanger des commandes, pouvant mener à des changement de configuration des capteurs);
    \item l'organisation autonome du réseau (les réseaux de capteurs s'organisent de façon autonome, mais des attaques peuvent chercher à interférer avec la formation d'une architecture cohérente; dans ce paradigme sont inclus les protocoles de clusterisation éventuellement mis en application);
    \item l'agrégation de données (qui consiste à agréger, éventuellement compresser les données reçues avant retransmission, dans le but de limiter la taille et le nombre de paquets envoyés, afin de minimiser l'utilisation du canal de transmission, et surtout la consommation en énergie des capteurs);
    \item l'optimisation du modèle utilisé (qui intervient lorsque les capteurs ont des décisions à prendre, basées sur le contenu des paquets, telles que la retransmission directe ou différée, le niveau de sécurité à fournir\dots).
\end{itemize}

Cette méthode de classement est la plus utile pour se concentrer sur un point particulier du fonctionnement d'un réseau, et relever toutes les failles susceptibles d'affecter les opérations concernées.

À noter qu'il existe dans la littérature des classifications ontologiques (le système est représenté sous forme de graphe relationnel) des attaques de déni de service~\cite{VS10}, qui se rapproche quelque peu de la méthode présentée ici, même si les exemples traités portent le plus souvent sur les réseaux en général sans évoquer les capteurs.

La \tabref{ea:tab:paradigm} située plus bas présente un classement selon les paradigmes des attaques que nous allons introduire.
%2}}}

\subsubsection{Selon les couches de protocoles concernées}
%{{{2
Une seconde méthode efficace de classement consiste à procéder par couches de protocoles, en se basant sur le modèle TCP/IP (schéma concret lui-même issu du modèle théorique OSI, de l'anglais \textit{Open Systems Interconnection}).
Ce modèle est rappelé en \figref{ea:fig:tcpip}.
\begin{figure}[!ht]
    \centering
    \begin{tabular}{c |c| l}
        \multicolumn{2}{c}{} & Exemples:\\
        \cline{2-2}
        5 & Application & HTTP, FTP, SSH\\
        \cline{2-2}
        4 & Transport & TCP, UDP\\
        \cline{2-2}
        3 & Réseau & IP\\
        \cline{2-2}
        2 & Liaison & IEEE 802.11 (CDMA/CA)\\
        \cline{2-2}
        1 & Physique & ondes électromagnétiques\\
        \cline{2-2}
     \end{tabular}
    \medskip
    \caption{Modèle TCP/IP}\label{ea:fig:tcpip}
\end{figure}

Ce classement permet une revue efficace, couche par couche, de la plupart des attaques connues.
C'est donc selon ce critère que nous allons maintenant présenter les principales attaques de déni de service connues dans les réseaux de capteurs.
%2}}}
%1}}}

\subsection{Différents types d'attaques}
%{{{1

    \subsubsection{Couche physique}
%{{{2
La couche physique du réseau correspond au médium physique employé pour la transmission des données entre deux nœuds, et à la façon dont le signal est transmis au travers de ce médium.
Dans le cas de réseaux sans fil, le signal est propagé sous forme d'ondes électromagnétiques qui se déplacent dans le vide (ou bien, sans en être affectées, à travers l'atmosphère).
Sauf s'il est fait usage d'une antenne directionnelle pour l'émission, ces ondes sont envoyées dans toutes les directions, et tout appareil à portée équipé d'un récepteur se retrouve donc en mesure de recevoir les paquets émis.

        \paragraph{Brouillage de fréquences}
Le brouillage de fréquences (\textit{frequency jamming} en anglais) consiste pour l'attaquant à émettre un signal parasite, un « bruit » électromagnétique, sur les fréquences concernées, de façon à ce que la cible visée ne puisse plus recevoir de façon correcte les paquets qui lui sont envoyés par les nœuds légitimes.
Le brouillage peut être réalisé à l'aide d'une antenne directionnelle pour viser une cible en particulier; mais dans le cas d'un réseau de capteurs, l'attaquant cherche en général à émettre un bruit dans toutes les directions afin d'affecter le plus grand nombre de nœuds possible.
L'attaque peut être menée de façon sporadique, de manière à produire un déni de service partiel, ou bien en continu.
Si la ou les machine(s) émettant le signal parasite possède(nt) une portée suffisante pour couvrir toute l'étendue géographique du réseau, l'intégralité des capteurs peuvent se retrouver dans l'impossibilité d'utiliser les fréquences brouillées.
Si de plus, le brouillage est mené sur toute la plage de fréquences accessibles aux capteurs, les communications deviennent totalement impossibles à établir dans le réseau.

Il est à noter que mener une telle attaque peut être couteux en matériel pour l'attaquant, surtout s'il vise plusieurs fréquences et/ou un brouillage continu dans le temps.
Typiquement, un capteur corrompu ne sera pas en mesure de mener cette attaque sans épuiser très rapidement sa batterie.
%2}}}

    \subsubsection{Couche liaison de données}
%{{{2
La couche de liaison de données fournit les moyens fonctionnels et procéduraux pour le transfert des données entre deux entités du réseau.
Elle permet aussi, le plus souvent, de détecter et éventuellement corriger certaines erreurs survenues sur la couche physique (en cas de perturbation ou dégradation du signal électromagnétique).
Elle se décompose en deux sous-couches: la couche de contrôle de la liaison logique (LLC, pour \textit{Logical Link Control} en anglais) et la couche du contrôle d'accès au support (MAC, pour \textit{Media Access Control}).
C'est principalement cette seconde couche qui nous intéresse ici: le protocole de couche MAC définit la manière dont les différents agents du réseau accèdent au médium de transmission de façon à limiter les collisions, et à garantir un accès le plus souvent équivalent au médium pour tous les nœuds.
Les différents modes d'accès au médium existants sont résumés dans la \tabref{ea:tab:mac}; certains consistent à créer des canaux de transmission distincts, tandis que d'autres déterminent l'accès à une même bande de fréquence en instaurant des règles.
Ces règles peuvent être contournées, et la couche MAC va donc se retrouver associée à plusieurs types d'attaques.

\begin{table}[!ht]
    \caption{Méthodes d'accès au médium de transmission}\label{ea:tab:mac}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.2\textwidth}|m{.2\textwidth}|m{.48\textwidth}}
            \toprule
            \textsc{Nom anglais} & \textsc{Traduction} & \textsc{Description}\\
            \midrule
            \multicolumn{3}{c}{Commutation de circuits et création de canaux}\\
            \midrule
            \textit{Frequency Division Multiple Access} (FDMA) & Accès multiple par répartition en fréquence & Plusieurs canaux basés sur des fréquences différentes\\
            \midrule
            \textit{Code division multiple access} (CDMA) & Accès multiple par répartition en code & Étalement du spectre de fréquence utilisé en conjonction avec techniques comme les sauts de fréquences ou la génération de bruit pseudo-aléatoires (avec la même séquence pseudo-aléatoire appliquée au signal côté émetteur comme côté destinataire)\\
            \midrule
            \textit{Time division multiple access} (TDMA) & Accès multiple à répartition dans le temps & Un seul canal dont l'accès est réparti par créneaux dans le temps\\
            \midrule
            \textit{Space division multiple access} (SDMA) & Accès multiple à répartition dans l'espace & Plusieurs canaux spatiaux obtenus à l'aide d'antennes directionnelles. À noter: les antennes directionnelles augmentent sensiblement le cout de production des capteurs.\\
            \midrule
            \multicolumn{3}{c}{Mode d'accès par paquet}\\
            \midrule
            \textit{Contention based random multiple access methods} & Accès par contention & Contention par le nœud du paquet à envoyer jusqu'à ce que le protocole le lui autorise. Dans cette catégorie se trouve notamment le protocole CSMA/CA (\textit{Carrier Sense Multiple Access with Collision Avoidance}, accès multiple par écoute du canal avec esquive de collision), très utilisé dans les réseaux sans fil (IEEE~802.11 entre autres).\\
            \midrule
            \textit{Resource reservation (scheduled) packet-mode protocols} & Réservation des ressources & Réservation par un nœud des ressources (par exemple: créneau temporel) nécessaires à la transmission)\\
            \midrule
            \multicolumn{3}{p{.95\textwidth}}{D'autres modes d'accès par paquet (\textit{token passing, polling}) existent mais ne sont pas utilisés dans les réseaux de capteurs}\\
            \bottomrule
         \end{tabular}
     \end{small}
\end{table}

        \paragraph{Création de collisions et brouillage « intelligent »}
Lorsque plusieurs nœuds dont les portées se chevauchent émettent de façon simultanée en utilisant la même fréquence (donc sur un même canal), il se produit des collisions.
La plupart des protocoles MAC employés avec les réseaux de capteurs introduisent dans les trames un champ contenant une somme de contrôle, qui permet de vérifier l'intégrité de la trame.
Mais cette somme de contrôle ne permet pas, la plupart du temps, de corriger d'éventuelles erreurs (aucun des standards IEEE 802.11 (Wi-Fi), 802.15.1 (Bluetooth) ou 802.15.4 (ZigBee, 6LoWPAN) n'inclue de code de correction des erreurs).
Si un seul bit de la trame est altéré, celle-ci est donc rejetée par le destinataire.
Un attaquant peut donc chercher à produire des collisions en émettant un signal en même temps qu'un nœud légitime, afin que le destinataire ne puisse pas recevoir correctement la trame qui lui est destinée.
Ce principe de collision est identique au brouillage mené sur la couche physique; mais lorsque l'attaquant a connaissance du protocole de couche MAC employé, il lui est possible d'affiner son attaque, et de remplacer un brouillage « brut », continu et onéreux, par un brouillage « intelligent ».
Il existe plusieurs façons de procéder~\cite{PI11}:
\begin{itemize}
    \item la première, comme vu plus haut, n'est pas « intelligente » et consiste à brouiller les fréquences de manière continue, en produisant un bruit aléatoire;
    \item une technique plus difficile à détecter consiste à envoyer des paquets normaux mais de façon continue, de façon à occuper le canal sans interruption. Elle empêche les nœuds légitimes de transmettre dans le cas ou le protocole de couche MAC est CSMA/CA par exemple;
    \item une technique plus économe consiste à envoyer des bits à intervalles distincts (réguliers ou non), dans l'espoir de créer des collisions. Il n'est alors plus nécessaire d'émettre en continu, et l'attaque est moins facile à détecter. Elle est bien sûr moins efficace, car l'attaquant n'a plus la garantie de brouiller tous les paquets émis;
    \item les attaques « intelligentes » à proprement parler reposent sur la connaissance des spécifications du protocole MAC employé, et consistent à jouer sur la nature des paquets de contrôle et les délais d'attente. Ainsi, pour le protocole CSMA/CA employé avec la suite IEEE~802.11~\cite{ieee802.11}, une trame spécifique dite RTS (\textit{Request To Send} en anglais) de demande de réservation du canal est suivie d'une trame CTS (\textit{Clear To Send}) après une durée SIFS (\textit{Short InterFrame Space}) si le destinataire est prêt à recevoir des données. En créant une collision sur la seule trame CTS, l'attaquant prévient entièrement l'échange de données utiles entre les nœuds.
D'autres trames peuvent être utilisées dans le même but, leurs acronymes sont dans la \tabref{ea:tab:smartjam}.
\end{itemize}

\begin{table}[!ht]
    \caption{Brouillage « intelligent »: corruption des trames de contrôle}\label{ea:tab:smartjam}
    \centering
    \medskip
    \begin{tabular}{c c c}
        \toprule
        \textsc{Paquet analysé} & \textsc{Temps d'attente} & \textsc{Paquet à corrompre}\\
        \midrule
        RTS & SIFS & CTS\\
        DATA & SIFS & ACK\\
        RTS & DIFS & DATA\\
        Quelconque & DIFS & RTS ou DATA\\
        \bottomrule
    \end{tabular}
\end{table}

        \paragraph{Épuisement de la batterie}
Corrompre des trames à moindre cout permet à un attaquant de forcer une cible à émettre davantage de trames que prévu, puisqu'un échec de communication est généralement suivi de plusieurs autres tentatives.
À chaque nouvel essai, la cible doit émettre à nouveau la trame complète, et puise donc dans ses réserves énergétiques pour alimenter son bloc d'émission.
Étant donné qu'il est très difficile de changer la batterie d'un capteur une fois le réseau déployé, un capteur dont la batterie est vide cesse d'être opérationnel, et ne remplit plus du tout son rôle.
L'attaquant peut donc chercher à épuiser la batterie d'un ou de plusieurs nœuds à portée, soit en leur faisant émettre plus de trames que nécessaires (collisions), soit en les retenant le plus possible en état d'activité (émission ou écoute du canal) pour les empêcher de rentrer dans un état de veille qui permet l'économie des ressources (attaque par privation de sommeil).
Une autre méthode consiste encore à pousser la cible à mener des calculs intensifs: morsque des algorithmes cryptographiques sont mis en application notamment, chaque requête, même rejetée, se traduit par un nombre important de calculs nécessaires pour vérifier la signature d'un message.
Si l'attaquant se sert d'un capteur corrompu ou d'un appareil équivalent pour mener son attaque, il lui est essentiel d'émettre le moins de signaux possibles pour économiser son énergie, et ne pas vider sa batterie au même rythme que ses cibles (au risque de devenir inactif avant les nœuds visés).

        \paragraph{Accaparement du canal de transmission}
Un appareil compromis introduit dans le réseau peut chercher à s'octroyer un accès plus important que les agents légitimes au canal de transmission.
Ce comportement cupide (ou \textit{greedy} en anglais) peut être atteint par exemple en jouant sur les paramètres du protocole de couche MAC: non respect des durées minimales DIFS entre deux envois (pout IEEE~802.11 par exemple), non respect des valeurs employées pour la taille des fenêtres de congestion, non respect de la réservation des ressources par d'autres nœuds, \etc.
Le but final de telles attaques peut être d'envoyer plus de données à la station de base, dans le but par exemple de fausser une moyenne, ou bien de transmettre les données écoutées (attaque sur la confidentialité) dans le voisinage à une autre machine corrompue du réseau, en vue de l'exfiltration de ces données utiles capturées.

        \paragraph{Falsification d'accusés de réception}
La falsification d'un accusé de réception, à destination d'un nœud venant d'émettre des données, permet à un attaquant d'empêcher ce nœud de réaliser d'autres tentatives de transmission de la trame.
Elle n'est utile, bien entendu, que dans le cas où l'attaquant pense que l'émission de la trame d'origine a échoué, par exemple parce qu'il a créé une collision sur le canal lors de cette première émission.
C'est une attaque qui vient compléter les techniques de brouillage de façon à empêcher la transmission de l'information dans le réseau.
%2}}}

    \subsubsection{Couche réseau}
%{{{2
La couche réseau, pour les capteurs sans fils, repose le plus souvent sur le protocole IP (\textit{Internet Protocol} an anglais), que ce soit en version 4 ou 6 (la version 6 est notamment utilisée avec la pile 6LoWPAN), pour l'adressage, et sur un protocole de routage qui détermine comment les paquets sont retransmis saut après saut dans le réseau.
Dans le cas d'un réseau clusterisé, il arrive que tous les capteurs soient à portée directe de leur \ch, et que ce dernier soit en mesure d'atteindre directement la station de base.
Le routage est alors très simple.
Mais dans d'autres cas, il est nécessaire d'établir une structure pour le réseau permettant l'acheminement des paquets jusqu'à leur destinataire.
Un protocole de routage efficace doit minimiser les pertes de paquets ainsi que les couts de retransmission et éviter la création de boucles dans le réseau.
À l'inverse, un attaquant peut tenter de mener une attaque par déni de service en gênant le plus possible l'acheminement de ces paquets.

        \paragraph{Trou noir (\textit{blackhole})}
Une attaque de type « trou noir » (ou \textit{blackhole} en anglais) consiste pour un nœud compromis à n'effectuer aucune retransmission des paquets qui lui sont envoyés.
Le nœud accuse réception du paquet auprès de l'émetteur, mais ne transmet jamais le paquet pour le prochain saut prévu pour ce paquet par le protocole de routage.
Toutes les routes qui passent par ce nœud compromis mènent donc à la suppression pure et simples des paquets en cours de transit.

        \paragraph{Retransmission sélective de paquets (trous gris (\textit{grey holes}), attaques « on/off » (\textit{on/off holes}))}
Là où une attaque de type « trou noir » supprime tous les paquets au lieu de les retransmettre, il est possible de ne retransmettre à la place qu'un sous-ensemble de paquets.
L'attaque devient plus difficile à détecter, puisque le nœud compromis retransmet tout de même des paquets de temps à autre.

Les attaques basées sur ce mécanisme sont dites à retransmission « on/off » (\textit{on/off holes} en anglais) lorsque la retransmission de tous les paquets est soit complètement assurée, soit complètement suspendue en alternant entre ces deux phases au fil du temps.
On parlera plutôt d'attaques de type « trou gris » (\textit{grey holes} en anglais) lorsque la retransmission est partielle mais constante dans le temps, qu'elle soit basée sur un mécanisme aléatoire (paquets supprimés au hasard plutôt que d'être retransmis) ou selon des règles (selon le contenu utile, ou selon l'expéditeur ou le destinataire par exemple).

        \paragraph{Falsification des informations de routage (accaparement du canal de transmission, création de boucles, \etc)}
Une attaque peut être menée dès le déploiement du réseau en transmettant de fausses informations lors de la mise en place des règles de routages.
Ces informations vont alors chercher à nuire au routage des paquets, en créant des boucles cycliques dans la structure de routage, en partitionnant le réseau, en attirant à tord le trafic vers un nœud corrompu (par exemple pour exploiter les données et porter une attaque sur la confidentialité) ou vers un nœud légitime (pour surcharger ses capacités de traitement)\dots

De telles attaques peuvent aussi être menées lorsqu'un protocole de clusterisation est mis en application, dans le but de gêner l'organisation structurelle du réseau (puisque la mise en place des clusters définit le plus souvent la façon dont les paquets seront routés dans le réseau).

Plusieurs autres attaques présentées ci-dessous reposent sur la falsification des informations de routage.

        \paragraph{Puits (\textit{sinkhole})}
Une attaque \textit{sinkhole} en anglais est la combinaison d'une attaque de type « trou noir » avec la diffusion de fausses informations de routage, en vue d'attirer le maximum de paquets possible vers le nœud attaquant.
Concrètement, un nœud corrompu peut se déclarer voisin direct de la station de base et annoncer une route de cout nul vers cette dernière.
Ses voisins vont estimer qu'il s'agit du plus court chemin pour acheminer les paquets jusqu'à la station de base, et vont transmettre l'information à leur tour.
Au final une part importante des routes créées, et en conséquence du trafic routé, va passer par ce nœud compromis, ce qui peut mener à des congestions dans le réseau.
Rentre alors en jeu l'attaque \textit{blackhole}, qui supprime tous les paquets reçus plutôt que de les retransmettre à leur destinataire légitime.

Une conséquence supplémentaire de cette attaque est l'épuisement de la batterie des nœuds voisins de l'attaquant: comme celui-ci se déclare très proche de la station de base, un grand nombre de routes vont rediriger les paquets vers lui, et ses voisins vont donc se retrouver fortement sollicités par des nœuds plus éloignés pour lui acheminer des paquets.

Il est à noter que la littérature inverse parfois, et même confond de temps en temps, la terminologie des attaques de type \textit{blackhole} et \textit{sinkhole}.
Les définitions présentées ici sont celles qui semblent revenir le plus couramment.
Par ailleurs, tous les « trous » ne font pas nécessairement référence à des pertes de paquets: des trous physiques, logiques ou sémantiques peuvent se former dès le déploiement du réseau~\cite{JSM13}, mais il s'agit d'un problème qui tient davantage de la sureté et de la résilience que de la sécurité.

        \paragraph{Trou de ver (\textit{wormhole})}
Lorsque deux agents ou plus du réseau sont compromis par un attaquant, il leur est possible de mener une attaque de type « trou de ver » (\textit{wormhole attack} en anglais).
Cette attaque consiste à capturer du trafic en un point donner du réseau pour le réinjecter en un autre point.
Il faut donc au moins deux agents complices, l'un qui capture et l'autre qui injecte le trafic, et qui communiquent l'un avec l'autre par le biais d'un canal auxiliaire généralement distinct des canaux légitimes utilisés sur le réseau (un tunnel, ou « trou de ver », qui donne son nom à l'attaque).
Il est intéressant, pour les nœuds menant l'attaque, de retransmettre par exemple les informations (de routage, notamment) provenant du voisinage de la station de base en un point éloigné du réseau, de façon à faire passer le tunnel pour une route de bonne qualité vers la station de base, puis de mener des attaques de retransmission sélective.
Ou plus simplement, l'injection en un autre point des paquets utilisés pour la découverte de routes lors de la mise en place de la structure de routage peut nuire grandement à l'organisation du réseau, et conduire un nœud légitime à imaginer des voisins virtuels qui sont en réalité absolument hors de sa portée d'émission.

        \paragraph{Déluge de paquets « hello » (\textit{“hello” flooding})}
Un mécanisme souvent mis en place dans les réseaux de capteurs est l'envoi de paquets de type « hello » pour découvrir quels sont les nœuds dans leur voisinage.
À la réception d'un tel paquet, les nœuds voisins émettent en réponse un paquet « hello-reply » indiquant au premier capteur qu'ils ont reçu le message.
Un attaquant, s'il dispose d'une machine plus puissante que la moyenne des capteurs, peut forger et envoyer des paquets « hello-reply » avec une portée supérieure à celle des capteurs, pour leur faire enregistrer des voisins qui sont en réalité bien au-delà de leur portée d'émission, et désorganiser complètement le routage de paquets dans le réseau.

        \paragraph{Altération des données}
Lorsqu'aucune vérification de l'intégrité des données n'est réalisée, un nœud relais corrompu peut, s'il a accès au contenu (en clair ou parce qu'il possède la clé pour déchiffrer), modifier ou retrancher des données du paquet à retransmettre.
Les données qui parviennent à l'exploitant du réseau sont alors erronées ou incomplètes.

        \paragraph{Attaque Sybil}
Le nom de l'attaque « Sybil » provient du titre du roman éponyme écrit par Flora Rheta \textsc{Schreiber}, publié en 1973 et racontant le traitement d'une patiente souffrant de multiples dédoublements de la personnalité.
L'attaque en elle-même consiste justement pour un agent corrompu à endosser l'identité de plusieurs nœuds dans le réseau.
Ce peut être l'identité:
\begin{itemize}
    \item inventée, de nœuds inexistants;
    \item de nœuds existants, mais distants du nœud corrompu;
    \item de nœuds détruits et virtuellement remplacés par le nœud corrompu.
\end{itemize}
Cette mascarade permet au nœud compromis de faire échouer d'éventuels schémas de résilience, par exemple lorsque le protocole de routage prévoit des routes « de secours » si les routes principales venaient à être coupées.
Des schémas de partition, de réplication, de distribution du stockage de l'information se retrouvent également affecter si des nœuds qui sont considérés comme distincts par les agents légitimes sont en fait simulés par un unique capteur compromis.
Le mécanisme peut également être utilisé dans le but d'intensifier d'autres attaques~\cite{NSSP04}, notamment:
\begin{itemize}
    \item l'altération des données finales récupérées par l'exploitant, en transmettant des données erronées en provenance d'un grand nombre de capteurs virtuels;
    \item l'exclusion de nœuds légitimes du réseau dans le cas où une solution de détection est mise en place (voir plus bas), en simulant un comportement irrégulier de la part de ces nœuds, ou en votant contre eux sous le couvert de plusieurs identités de façon à remporter ces votes;
    \item l'accaparement de ressources, en réservant des ressources (créneaux temporels pour l'accès au canal\dots) pour plusieurs nœuds virtuels, mais qui ne seront utilisées que par le seul capteur menant l'attaque.
\end{itemize}
De manière générale, en l'absence d'un système efficace d'authentification, les attaques reposant sur des techniques d'usurpation d'identité peuvent être très compliquées à détecter et à contrecarrer correctement.
%2}}}

    \subsubsection{Couche transport}
%{{{2
La couche transport gère les communications de bout en bout entre processus.
Les protocoles les plus fréquemment utilisés, TCP (\textit{Transmission Control Protocol}) et UDP (\textit{User Datagram Protocol}) assurent l'ordonnancement des paquets et permettent d'éviter les pertes, les doublons et la corruption des paquets.
Le protocole TCP permet en plus à deux entités de communiquer en mode connecté en établissant une session (début, fin et validation des échanges).
En raison des données de contrôle que ces protocoles impliquent, ils ne sont pas systématiquement implémentés dans les réseaux de capteurs (ils le sont parfois dans des versions allégées).

        \paragraph{Déluge de paquets SYN (ou équivalents) (\textit{SYN flooding})}
Les attaques par déni de service existant sur les réseaux classiques au niveau de la couche transport peuvent aussi être appliquées dans les réseaux de capteurs: par exemple, si le protocole TCP est utilisé dans le réseau, un attaquant peut inonder le réseau de paquets SYN utilisés pour initier des connexions entre deux nœuds.
Cette attaque requiert une machine plus puissante (surtout, avec une meilleure alimentation en énergie) qu'un capteur, mais permet à la fois de créer des congestions dans le réseau, et de saturer les capacités des capteurs en ouvrant un nombre trop grand de sessions TCP.

        \paragraph{Désynchronisation TCP (ou équivalents)}
Dans le même registre, un attaquant peut forger des demande de désynchronisation pour mettre fin à des sessions TCP établies entre deux entités légitimes.
Les échanges de ces sessions sont donc interrompus jusqu'au rétablissement d'une nouvelle connexion: ces connexions impliquent l'envoi de données de contrôle (elle s'effectue en trois temps, on parle de \textit{three-way handshake} en anglais) qui consomment une quantité d'énergie précieuse pour les capteurs.
%2}}}

    \subsubsection{Couche application}
%{{{2
La couche application implémente éventuellement l'application utilisée au niveau le plus haut par le réseau de capteur pour assurer un service en particulier.
Les protocoles utilisés sur cette couche dépendent donc totalement de l'objectif final du réseau, il n'y a pas ici de standard à proprement parler.
Certaines attaques sont néanmoins applicables au niveau applicatif.

        \paragraph{Données erronées}
Un nœud compromis peut envoyer des données en parfaite contradiction avec les valeurs physiques mesurées (voire même, il peut s'affranchir des mesures et ainsi économiser de l'énergie).
Les valeurs transmises au niveau application viendront alors fausser les résultats obtenus par l'exploitant du réseau.

        \paragraph{Déluge de paquets}
Suivant l'application mise en place, il peut être envisageable pour un attaquant d'inonder le réseau de données utiles, qu'elles aient été effectivement mesurées ou non, soit dans une tentative de fausser les résultats obtenus par la station de base en faisant des moyennes sur les valeurs rapportées par l'ensemble des capteurs, soit pour créer des congestions dans le réseau.

        \paragraph{Désynchronisation}
Si jamais le protocole utilisé sur la couche application induit la création de sessions en mode connecté (comme pour TCP sur la couche transport), des attaques de désynchronisation peuvent être menées par un attaquant en vue de briser ces sessions.
%2}}}

    \subsubsection{Hors modèle}
%{{{2
        \paragraph{Destruction physique des capteurs}
Les capteurs sont des appareils de petite taille déployés en nombre, et dont la production ne doit par conséquent pas être trop couteuse.
Cela implique que les appareils sont relativement fragiles, et d'autant plus difficiles à sécuriser que le réseau est souvent déployé en extérieur, parfois en environnement hostile.
Un attaquant peut donc parfois accéder directement au capteur lui-même.
C'est l'une des manières de s'emparer d'un capteur pour le reprogrammer et introduire un agent corrompu dans le réseau (l'autre méthode reposant sur des failles logicielles, qui permettent parfois l'injection distante de code).
Mais sans s'embarrasser de les reprogrammer, l'attaquant peut aussi se contenter de détruire physiquement les capteurs, ce qui est encore le moyen le plus efficace de les empêcher de fournir les services pour lesquels ils ont été conçus.

        \paragraph{Altération des mesures}
Toujours en raison de leur exposition physique, les capteurs peuvent être manipulés par un attaquant pour mesurer des données.
Des engins munis de caméras peuvent ainsi voir leur objectif obstrué (par une couche de peinture par exemple); ou bien des capteurs chargés de mesurer la température d'un élément donné peuvent être déplacés, de sorte à ce que leur thermomètre ne soit plus en contact avec cet élément.
Les capteurs continuent dans ce cas à mesurer des valeurs et à les retransmettre jusqu'à la station de base, mais ces mesures elles-mêmes (et donc les résultats obtenus par l'exploitant) se retrouvent faussées dès le départ.

        \paragraph{}
Les tables~\ref{ea:tab:layer} et~\ref{ea:tab:paradigm} synthétisent le classement de ces différentes attaques, respectivement par couche du modèle TCP/IP et par paradigme considéré.
Toutes les attaques exposées dans cette sous-section ont été décrites à maintes reprises dans la littérature, et notamment réunies au travers de plusieurs études portant sur l'état de l'art de la sécurité dans les réseaux de capteurs~\cite{SSS11,RM11,AD14}
\begin{table}[!ht]
    \newcounter{LayerNumber}
    \setcounter{LayerNumber}{1}
    \newcommand\num[1]{\theLayerNumber.~#1\stepcounter{LayerNumber}}
    \caption{Classement des attaques par couche du modèle TCP/IP}\label{ea:tab:layer}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.21\textwidth}|p{.71\textwidth}}
            \toprule
            \textsc{Couche} & \textsc{Attaques possibles}\\
            \midrule
            \multirow{2}{*}{Hors modèle}%
                & \num{Destruction physique des capteurs}\\
                & \num{Altération des mesures}\\
            \midrule
            \multirow{1}{*}{Couche physique}%
                & \num{Brouillage de fréquences}\\
            \midrule
            \multirow{4}{*}{\parbox{.2\textwidth}{Couche liaison de données}}%
                & \num{Création de collisions, brouillage « intelligent »}\\
                & \num{Épuisement de la batterie}\\
                & \num{Accaparement du canal de transmission}\\
                & \num{Falsification d'accusés de réception}\\
            \midrule
            \multirow{8}{*}{Couche réseau}%
                & \num{Trou noir}\\
                & \num{Retransmission sélective de paquets (trous gris, attaques « on/off »)}\\
                & \num{Falsification des informations de routage (accaparement du canal, création de boucles, \etc)}\\
                & \num{Puits}\\
                & \num{Trou de ver}\\
                & \num{Déluge de paquets « hello »}\\
                & \num{Altération des données}\\
                & \num{Attaque Sybil}\\
            \midrule
            \multirow{2}{*}{Couche transport}%
                & \num{Déluge TCP (ou équivalents)}\\
                & \num{Désynchronisation TCP (ou équivalents)}\\
            \midrule
            \multirow{3}{*}{Couche application}%
                & \num{Données erronées}\\
                & \num{Déluge de paquets}\\
                & \num{Désynchronisation}\\
            \bottomrule
        \end{tabular}
    \end{small}
\end{table}
\begin{table}[!ht]
    \caption{Classement des attaques par paradigme (voir \sssref{ea:sss:paradigm})}\label{ea:tab:paradigm}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.3\textwidth}|m{.62\textwidth}}
            \toprule
            \textsc{Paradigme} & \textsc{Attaques possibles}\\
            \midrule
            Collecte et transmission simples & Brouillage, création de collisions, destruction des capteurs, altération des mesures, altération des données (applicatif)\\
            \midrule
            Routage des données dans le réseau & Retransmission sélective, trous noirs, épuisement des ressources (batterie, congestion du réseau), altération des données (lors de la retransmission), accaparement du canal de transmission, attaques au niveau de la couche transport\\
            \midrule
            Réception et traitement de commandes & attaques précédentes, usurpation d'identité (et attaque Sybil) utilisée pour émettre de fausses commandes\\
            \midrule
            Organisation autonome du réseau & attaques précédentes, fausses informations de routage (boucles\dots), puits, trous de ver, déluge de paquets « hello »\\
            \midrule
            Agrégation de données & attaques précédentes, en particulier celles basées sur le rejeu de paquets émis ou capturés\\
            \midrule
            Optimisation des modèles & attaques précédentes\\
            \bottomrule
         \end{tabular}
     \end{small}
\end{table}

Il est bien sûr très difficile de prétendre à l'exhaustivité, et il existe d'autres attaques de déni de service applicables au réseaux de capteurs: certaines dépendent d'applications particulières ou sont introduites par des configurations spécifiques (mobilité des nœuds, structures spécifiques: grille, recherche de couverture maximale\dots).
D'autres n'ont sans doute pas encore été découvertes.
Les attaques que nous avons présentées regroupent néanmoins les principales menaces, en termes de déni de service, auxquelles peuvent faire face les réseaux de capteurs.
%2}}}
%1}}}

\subsection{Prévenir les attaques}
%{{{1

    \subsubsection{Authentification et problématiques similaires}
%{{{2
La sécurité est transversale à l'ensemble des domaines d'études en informatique, et la protection contre le déni de service\dots est elle-même liée aux autres problématiques de sécurité.
Il faut entendre par là que si des failles du système compromettant l'authentification des agents ou l'intégrité des données peuvent également être exploitées d'une façon ou d'une autre pour nuire au bon fonctionnement du réseau, alors l'attaque en question vient également se classer parmi les attaques de déni de service.

De manière plus concrète, assurer correctement l'authentification des nœuds du réseau empêchera un attaquant de mener des attaques basées sur l'usurpation de l'identité d'un autre nœud.
Les attaques par désynchronisation, ou la falsification d'accusés de réception par exemple, deviennent inapplicables.
Si des mécanismes permettant de limiter le rejeu de paquets capturés sont rajoutés, l'ampleur des attaques Sybil ainsi que des attaques par trou de ver se verront fortement réduites.
La protection de l'intégrité des données assure de son côté l'échec de toute tentative d'altération des valeurs transmises lors des opérations de routage.

Les mécanismes dédiés à la protection de l'authentification, de l'intégrité, ou contre le rejeu, présentés en \sref{ea:sec:secu}, sont donc également utiles pour protéger un réseau de capteurs de certaines attaques de déni de service.
On parle de mesures de prévention, dans le sens où il s'agit de méthodes mises en place pour empêcher une attaque de survenir.
De nombreuses architectures de sécurité, qui apportent authentification, chiffrement, intégrité et protection contre le rejeu aux échanges, et parmi lesquelles une bonne partie des solutions présentées en \sssref{ea:sss:archi}, se « vantent » ainsi d'atténuer, voire de prévenir totalement plusieurs types d'attaques de déni de service.
%2}}}

    \subsubsection{Des protocoles de routage spécifiques}
%{{{2
Toujours dans le but de prévenir les attaques, il est possible d'utiliser des protocoles de routage spécifiquement étudiés pour limiter les risques.
Ainsi, le protocole de routage AODV (\textit{Ad hoc On-demand Distance Vector routing}), très utilisé dans les réseaux de capteurs, a fait l'objet de propositions destinées à améliorer sa résistance aux attaques de déni de service de type \textit{blackhole} et \textit{sinkhole}: une étude propose par exemple de faire vérifier par chaque nœud, lors de la création des routes, que ses voisins de deuxième degré sont bel et bien accessibles~\cite{DLA02}.
Ainsi chaque nœud $x$ ayant un voisin $n$ qui lui propose une route vers une destination donnée, $x$ demande à $n$ quel est le prochain saut $n+1$ sur cette route et tente de contacter ce nœud $n+1$ pour vérifier qu'il est effectivement accessible.
Si $n+1$ répond, alors $n$ est digne de confiance pour cette route; puisqu'il est digne de confiance, on admet qu'il pourra à son tour vérifier l'accessibilité du nœud $n+2$ à travers le saut annoncé par $n+1$, et ainsi de suite tout au long de la route empruntée pour les données.

Toujours pour parer aux attaques sur le routage, d'autres méthodes se basent sur des mécanismes de redondance et de résilience, pour faire en sorte que si l'une des routes se révèle défectueuse, d'autres exemplaires des paquets, envoyés par des routes distinctes, puissent attendre leur destination.
Des mécanismes tels que le partage de secret peuvent être utilisés à cette fin de redondance, pour limiter l'augmentation du volume de données envoyées~\cite{MMB13}.
%2}}}

    \subsubsection{Prévenir la compromission des capteurs}
%{{{2
        \paragraph{Compliquer l'accès aux capteurs}
%{{{3
Il est en fin de compte très difficile de cacher la localisation géographique d'un capteur à un attaquant déterminé.
Des mécanismes alliant clusterisation et usage de fausses sources pour les messages peuvent être employés afin de compliquer la tâche à l'attaquant~\cite{GK13}.
L'usage d'antennes directionnelles peut également complexifier la localisation des nœuds, mais n'est pas adapté à toutes les utilisations des réseaux de capteurs.
Au final, un attaquant correctement équipé pourra toujours trouver un capteur en procédant par triangulation du signal électromagnétique.

Il peut alors devenir intéressant de cacher à l'attaquant quels sont les nœuds qui représenteraient le plus d'intérêt pour lui.
Un exemple traité est le jeu des « chasseurs de panda »: des capteurs dispersés dans l'habitat naturel d'un panda suivent les déplacements de l'animal et les rapportent à une station de base.
Mais des braconniers recherchent l'animal et tentent d'utiliser les données du réseau en vue de le localiser plus facilement.
S'il est impossible de cacher le signal des capteurs et d'empêcher les attaquants d'accéder directement aux machines, il est en revanche possible de déployer des mécanismes pour empêcher les chasseurs de savoir quel est le capteur qui renvoie à un instant donné les informations sur la présence du panda dans son secteur.
Un mécanisme pour disséminer l'information, basé sur le modèle des épidémies, a ainsi été proposé dans cet exemple~\cite{KDA14}.
Si l'on se concentre uniquement sur le déni de service, il est tout à fait possible d'imaginer l'utilisation de techniques similaires afin de dissimuler à l'attaquant quels sont les nœuds à compromettre pour infliger un maximum de dégâts au bon fonctionnement du réseau.

Une autre approche possible~\cite{Ho10} est de considérer que tout capteur ayant cessé de donner des « signes de vie » pendant une période prolongée est devenu hors-service, et qu'à ce titre il n'est plus censé réintégrer le réseau à l'avenir.
Cette période est par exemple déterminée à l'aide d'un algorithme SPRT (\textit{Sequential Probability Radio Test}) qui calcule la durée au-delà de laquelle l'absence de signal devient anormal.
Si le nœud tentait malgré tout de reprendre son activité au-delà de la période, alors supposition est faite que le capteur a été retiré du réseau par un attaquant le temps de procéder à une modification de son code, et ce nœud se retrouve alors volontairement exclu du réseau par mesure de précaution.
%3}}}

        \paragraph{Durcir la sécurité logicielle}
%{{{3
Si un attaquant parvient à accéder physiquement à un capteur, il devient très compliqué de l'empêcher d'accéder au contenu de la mémoire de l'appareil, et/ou de le reprogrammer selon ses besoins.
Des méthodes de chiffrement de la mémoire (principalement pour la mémoire non volatile) existent, mais sont peu implémentés sur les capteurs, car ils augmentent significativement la consommation en ressources de la machine et diminuent ses performances.
Des modifications malveillantes du code exécuté par un nœud peuvent parfois être détectées, comme nous le verrons lorsque nous traiterons des systèmes de détection d'intrusion machine en \sssref{ea:sss:hids}.

Mais outre les accès physiques directs, un attaquant peut très bien tenter de compromettre à distance un capteur, en exploitant des failles logicielles.
Des injections de code ont déjà été menées avec succès sur des capteurs, en utilisant par exemple des dépassements de tampons pour injecter une fausse pile d'exécution et mener une attaque dite \textit{return-into-libc}~\cite{FC08}.
La sécurité logicielle des capteurs doit donc être vérifiées avant même le déploiement du réseau.
Les bonnes pratiques d'ordre générale en sécurité s'appliquent ici comme ailleurs: de bonne pratique de développement pour le système sont indispensables, de même que la désactivation des services non utilisés (qui de toute façon consommeraient inutilement de l'énergie).
La sécurité du système peut éventuellement être spécifiquement renforcée, comme par exemple avec grsecurity pour des systèmes basés sur Linux~\cite{GFN11}.
%3}}}
%2}}}
%1}}}

\subsection{Détecter les attaques: systèmes de détection d'intrusion}
%{{{1

\subsubsection{Différents systèmes de détection d'intrusion}
%{{{2
La détection des attaques de déni de service passe par la mise en place d'un système spécifique, apte à collecter des indices permettant de déterminer si une attaque a lieu et, si possible, quelle en est l'origine.
On parle de « systèmes de détection d'intrusion », ou IDS pour \textit{Intrusion Detection System}.
Pour être précis, il convient de relever que ces systèmes sont utilisés pour la détection de tous types d'attaques, y compris lorsqu'il ne s'agit pas de déni de service.
Les usages et les spécifications des IDS sont donc multiples: la \figref{ea:fig:idsmap} résume les différentes catégories existantes, que nous allons brièvement décrire.
Il existe différentes façon de les distinguer.
\input{\chapterpath/Figures/ids.tikz}

\paragraph{Selon l'origine de l'attaque}
Un système de détection d'intrusion peut se concentrer sur les attaques provenant de l'\textbf{extérieur} du réseau, menées par un attaquant qui chercherait à brouiller les fréquences utilisées ou bien, justement, à pénétrer dans le réseau.

À l'inverse, d'autres systèmes vont surveiller l'\textbf{activité interne} du réseau, afin de détecter d'éventuels nœuds corrompus, soit qu'ils cherchent à accaparer les ressources pour leur propre compte, soit qu'ils cherchent à détruire les ressources du réseau.

\paragraph{Selon l'objet de la surveillance}\label{ea:sss:hids}
Un IDS peut avoir pour tâche de surveiller l'\textbf{activité du réseau}, en analysant le trafic: le nombre de paquets transmis, leur origine ou leur destination, leur contenu, le taux de succès des transmissions sont autant d'indices à collecter pour déterminer si le réseau fonctionne dans des conditions normales.

En parallèle, d'autres systèmes peuvent être orientés vers la \textbf{sécurité de l'hôte} sur lequel ils sont exécuté.
Leur but est de détecter d'éventuelles tentatives de compromission de la machine.
Les opérations menées à cette fin peuvent comprendre:
\begin{itemize}
    \item la vérification de l'intégrité du système (par exemple en calculant périodiquement un condensat des fichiers exécutables critiques, afin de les comparer avec le condensat de leur version d'origine);
    \item la surveillance des journaux concernant les tentatives de connexion, afin de détecter des échecs répétitifs d'accès au système;
    \item la détection d'une activité inhabituelle au niveau de l'activité du processeur, des allocations mémoires, ou des entrées sorties, qui risqueraient de pénaliser le système d'exploitation en termes de performance et de consommation énergétiques. Cette surveillance peut être menée en temps réel, ou via la journalisation des évènements système.
\end{itemize}
On parle en anglais de NIDS (\textit{Network Intrusion Detection System}) ou de HIDS (\textit{Host based Intrusion Detection System}) pour les IDS orientés réseau ou machine, respectivement.
De nombreux IDS cumulent à la fois des mécanismes de surveillance du réseau et du comportement de leurs voisins, et une surveillance des évènements système survenant sur leur hôte.

\paragraph{Selon le type d'intrusion à détecter}
Les IDS sont utilisés pour lutter contre tous types d'« intrusions » (ou d'attaques dans le sens plus général), pas seulement contre le déni de service, bien que ce soit le point qui nous préoccupe le plus dans cette thèse.
Ainsi ils peuvent être utilisés afin de détecter:
\begin{itemize}
    \item des \textbf{tentatives d'accès au réseau} de la part d'un attaquant externe (qui chercherait à passer par exemple par la compromission d'un nœud ou par l'obtention de matériel cryptographique); cette étape n'est souvent qu'un prélude à d'autres attaques (de déni de service notamment);
    \item un \textbf{accès à des ressources non autorisées}, lorsque qu'un capteur tente par exemple de procéder à certaines opérations dans un cluster qui n'est pas le sien;
    \item les \textbf{fuites de données}, qui peuvent être difficiles à détecter si l'attaque est passive (simple écoute des données circulant sur le réseau), mais peuvent être identifiées lors de l'extraction de ces données vers l'extérieur du réseau;
    \item les \textbf{comportements cupides} provoquant le blocage des ressources, par accaparement;
    \item les autres attaques de service, \cad les \textbf{comportements destructeurs}, visant à nuire au fonctionnement du réseau par l'anéantissement des ressources, qu'elles soient virtuelles (mise hors service des transmissions) ou bien physique (épuisement de la batterie des capteurs).
\end{itemize}

\paragraph{Selon les méthodes employées pour la détection}
Les méthodes utilisées pour déterminer l'existence et l'identité d'un attaquant sont nombreuses, et se divisent en trois catégories: la détection \textbf{basée sur les anomalies}, la détection \textbf{basée sur des signatures d'attaques}, et la détection reposant \textbf{sur la vérification du respect des spécifications}.
Ces catégories, et les principales méthodes qu'elles regroupent, sont détaillées plus bas en \sssref{ea:sss:detect}.

\paragraph{Selon l'infrastructure du réseau}
Si de nombreux IDS ne se préoccupent pas de savoir quelle est la configuration exacte du réseau, et sont élaborés sur des architectures « plates », \textbf{sur un seul niveau}, d'autres en revanche sont spécifiquement construits avec l'idée de tirer profit d'une \textbf{architecture clusterisée}.
La partition du réseau en clusters va de fait permettre la mise en place d'algorithme différents, le plus souvent distribués au sein des clusters.

Il est également intéressant de noter que la clusterisation en soi d'un réseau est un mécanisme efficace pour limiter la portée de la plupart des attaques de déni de service, dont les dommages seront en général circonscrit au cluster dans lequel elles sont menées.
Une exception concerne toutefois les attaques qui sont menées avec succès contre les \ch (notamment lorsque celui-ci se voit compromis), puisque ce peut être alors le cluster entier qui se retrouve hors service.

\paragraph{Selon la distribution des calculs}
La détection passe par la collecte puis le traitement d'indices sur le fonctionnement des nœuds ou du réseau global.
Collecte comme traitement peuvent être réalisés par différenties entités ou associations d'entités, à savoir:
\begin{itemize}
    \item le traitement, les calculs peuvent être \textbf{centralisés} et réalisés seulement par la station de base, à laquelle les capteurs font remonter les informations brutes relevées sur le fonctionnement du réseau. Dans certains cas extrêmes, même la collecte d'indices n'est réalisée que par la station de base;
    \item chaque capteur peut implémenter son propre système de détection d'intrusions: « \textbf{chacun pour soi} », quitte à garder pour lui ses conclusions sur le statut des autres nœuds. À l'inverse de la solution précédente, chaque capteur réalise alors de bout en bout les opérations de surveillance;
    \item la détection peut être menée par des \textbf{agents mobiles}, qui se déplacent de nœuds en nœuds dans un réseau de capteurs autrement statiques (ou peu mobiles en comparaison avec les agents de surveillance). Ces agents mobiles disposent en principe de ressources plus importantes que les capteurs ordinaires. Cette configuration ne peut bien sûr pas être déployée pour tous les usages des réseaux de capteurs;
    \item la collecte d'informations peut être \textbf{distribuée entre les nœuds} situés sur un même niveau d'horizontalité dans l'architecture du réseau: cette configuration leur permet d'échanger des informations entre eux, notamment des indices de confiance, et de déclencher des observations coordonnées lorsqu'un nœud « suspecte » un pair d'être compromis, sans en avoir la « certitude ». Lorsqu'un capteur est jugé définitivement compromis, l'information est partagée entre les nœuds. Dans certains systèmes, les calculs eux-mêmes peuvent être distribués;
    \item enfin, la distribution peut également être réalisée de façon \textbf{hiérarchique}, sur un plan vertical, dans les réseaux clusterisés. Il y a alors interaction entre les membres d'un cluster et leur \ch, qui se charge au minimum de la propagation des alertes, et parfois également des calculs à mener.
\end{itemize}

La gestion de la collecte et des calculs vont bien évidemment influencer l'opérateur du réseau sur le choix du type de méthode de détection (voir plus haut) à mettre en place.

\paragraph{Selon la fréquence d'usage du système}
La plupart des IDS sont prévus pour fonctionner \textbf{de manière continue} sur leur hôte, mais certaines solutions adoptent des comportement différents: le système de détection n'est exécuté que \textbf{de façon périodique}, ou bien se voit activé à la réception d'alerte (émanant de la station de base par exemple, qui dispose pour sa part des ressources nécessaires au maintien en continu d'un IDS).

\paragraph{Systèmes hybrides}
En pratique, pour un critère donné, la plupart des IDS proposés se retrouvent dans plusieurs catégories à la fois: on retrouve ainsi beaucoup de systèmes hybrides surveillant tout à la fois l'hôte sur lequel ils tournent, et le trafic intercepté par le nœud.
De même, le type d'attaques recherchées par les systèmes sont généralement multiples, et portent souvent sur plusieurs couches protocolaires (en référence au modèle TCP/IP).
Et pour en détecter un maximum, il n'est pas rare qu'un IDS combine plusieurs méthodes de détection.
On voit ainsi souvent apparaître en anglais le terme \textit{cross-layer IDS}, littéralement « IDS sur plusieurs couches ».
%2}}}

\subsubsection{Les méthodes de détection}\label{ea:sss:detect}
%{{{2
Une fois le réseau déployé, et le système de détection d'intrusion mis en place, les nœuds chargés de la surveillance du réseau analysent le trafic environnant et en tirent des déductions sur l'état des réseau.
Ces déductions résultent de l'application d'algorithmes précis sur les données.
Ces algorithmes sont de plusieurs sortes, que l'on regroupe dans les méthodes de détection basées sur des anomalies, sur des signatures d'attaques, ou sur le non-respect de spécifications prédéfinies.

\paragraph{Détection basée sur les anomalies}
Détecter les attaques selon les anomalies qui surviennent dans le réseau revient à établir, dans un premier temps, un modèle du fonctionnement normal du réseau.
Dans un second temps, la surveillance en elle-même est déclenchée, et si les variables observées dérogent sensiblement au modèle généré, une alerte est levée.
Ces méthodes permettent donc d'intervenir lorsqu'un problème survient effectivement dans le réseau, sans que son origine n'ait nécessairement été identifiée.
Elles ont pour avantage de s'adapter à de nouveaux types d'attaques, pour lesquelles elles n'avaient pas été imaginées au départ.
En revanche, elles peuvent être amenées à manquer certaines attaques connues dont les conséquences sont suffisamment discrètes.
Un second inconvénient existe: elles requièrent un réajustement constant du modèle par rapport à l'évolution normale du réseau, et la surveillance doit donc être maintenue tout à la fois pour détecter les attaques et pour mettre à jour le modèle.

La détection basée sur les anomalies regroupe trois sous-catégories.
\begin{itemize}
    \item La première est celle des \textbf{modèles statistiques}, qui enregistrent dans un premier temps des séries de valeurs pour des variables liées au bon fonctionnement du réseau, et cherchent par la suite à repérer les écarts importants à ces valeurs de référence. Les variables observées, directement liées au trafic, peuvent être considérées comme des variables indépendantes suivant des lois de \textsc{Gauss}, comme des variables corrélées, ou encore comme des séries temporelles.
    \item Une deuxième regroupe les modèles basés sur les \textbf{connaissances} modélisées du fonctionnement normal du réseau, et utilise un modèle généré en fonction des données et à l'aide d'outils tels que des langages de description ou des automates finis.
    \item Enfin, la détection peut être basée sur des \textbf{méthodes d'apprentissage}, où des modèles sont créés et actualisés \via des outils formels comme les processus de \textsc{Markov}, les réseaux bayésiens, la logique floue, les algorithmes génétiques, les réseaux de neurones, ou encore les modèles d'intelligence en essaim.
\end{itemize}

\paragraph{Règles et signatures des attaques}
Plutôt que d'attendre que des anomalies de fonctionnement, de performances, soient détectés, d'autres IDS prennent les devants et mettent en place un système de surveillance du voisinage en établissant un ensemble de règles à ne pas transgresser.
Ces règles sont construites à partir de la « signature » des attaques connues \cad, pour une attaque donnée, à partir du comportement type adopté par un nœud qui tenterait de mener cette attaque.

Les règles peuvent être nombreuses et variées, en voici quelques exemples représentatifs.
\begin{itemize}
    \item \textbf{Règle sur la fréquence des envois}: le délai entre deux paquets consécutifs, ou plus généralement la fréquence des messages émis sur un intervalle de temps par le nœud surveillé, ne doivent pas dépasser un certain seuil (minimal si l'on parle de délai, maximal pour une fréquence). Cette règle empêche un capteur de procéder à des attaques par déluge de paquets, ou bien d'accaparer le médium de transmission, sans être détecté.
    \item \textbf{Règle de retransmission}: les messages reçus par un nœud relais, mais à destination d'un autre nœud, doivent impérativement être retransmis par ce relais au nœud suivant sur la route définie pour ces paquets, ceci afin de détecter les attaques de type \textit{blackhole} ou \textit{sinkhole}.
    \item \textbf{Règle sur le délai de retransmission}: la retransmission en question par le relais ne doit pas être effectuée après un certain délai, afin d'éviter des ralentissements importants dans le réseau (cette règle est très proche de la précédente, qui est bien obligée de se baser sur un délai limite pour considérer que le paquet ne sera pas retransmis).
    \item \textbf{Règle sur l'intégrité}: Le contenu du message retransmis par le relais ne doit pas être altérée. Cette règle est bien entendu inapplicable lorsque le relais est censé effectuer un traitement (agrégation, traitement sémantique\dots) sur ce contenu avant de le retransmettre. Les attaques visées sont principalement celles visant l'intégrité des paquets.
    \item \textbf{Règle sur la répétition}: un message ne peut être transmis par un nœud donné au plus qu'un certain nombre de fois. Si ce seuil est dépassé, le nœud peut être suspecté de vouloir influencer les résultats collectés par la station de base. Si la répétition est espacée dans le temps, il peut aussi s'agir d'une tentative d'attaque par rejeu de paquets.
    \item \textbf{Règle sur la portée de transmission}: les paquets « entendus » par les nœuds de surveillance ne devraient provenir que de nœuds voisins dans le réseau, et non de nœuds que l'on sait éloignés. Réciproquement, les nœuds voisins ne sont pas censés émettre avec une puissance dépassant un certain seuil. Cette règle peut permettre de détecter des nœuds qui tenteraient de produire une fuite de données vers l'extérieur du réseau, ou bien de mener des attaques dans des zones plus éloignées du réseau (notamment des attaques sur le routage, en prétendant être voisin de nœuds distants, ou bien des attaques par trous de ver).
    \item \textbf{Règle sur les collisions}: pour lutter contre les tentatives de brouillage, un seuil peut être instauré pour le nombre maximum d'échecs de transmission dû à des collisions. Si ces collisions sont trop fréquentes et que le capteur qui en est à l'origine peut être identifié, il est considéré comme compromis.
    \item \textbf{Règles sur les accès}: si le nombre de tentatives d'un nœud pour s'enregistrer et obtenir un accès à certaines ressources dépasse un certain seuil, une alarme est déclenchée. Cette règle peut notamment s'appliquer à la détection des intrusions au niveau machine, lorsqu'une entité tente et échoue plusieurs fois de se connecter sur le système.
\end{itemize}

Lorsque les règles sont transgressées, une « alarme » est déclenchée.
Suivant le modèle de l'IDS, cette alarme peut n'être qu'une notification interne au capteur qui héberge le système, ou bien il peut partager l'information avec son entourage ainsi que, généralement, la station de base.
Les mesures à prendre en guise de réactions seront traitées plus bas.

Les nœuds qui observent le comportement de leurs voisins et veillent à l'application des règles choisies pour le réseau sont désignés de plusieurs façons: on parle de nœuds de contrôle, de nœuds de surveillance, éventuellement de sentinelles; en anglais, ce seront le plus souvent des \textit{monitoring nodes} (nœuds moniteurs).
L'expression \textit{watch dogs}, pour « chiens de garde », est aussi régulièrement employée.
Dans nos travaux, les nœuds chargés de cette surveillance sont appelés \cns.

La détection basée sur la signature des attaques est relativement simple à appréhender et à mettre en œuvre.
Elle est très efficace pour détecter les attaques connues, dont la signature est transcrite sous forme de règle servant à proscrire les comportements malicieux.
Ces règles sont faites de telle façon que le taux de faux positifs soit peu élevé.
De plus, cette méthode de détection est centrée sur l'observation du comportement individuel des nœuds voisins des sentinelles, et permet donc le plus souvent de localiser efficacement l'origine d'une attaque.
En revanche, elle souffre d'une mauvaise adaptation aux attaques nouvelles, dont le profil n'est pas connu, et risque ainsi de ne pas détecter d'intrusion alors même que les performances du réseau se retrouvent fortement dégradées.

\paragraph{Respect des spécifications}
Une troisième classe de méthodes de détection regroupe les méthodes, moins fréquentes, basées sur le respect de spécifications réalisées en amont du déploiement du réseau.
La détection basée sur les anomalies détecte les écarts de performance, celle basée sur les signatures relève les comportements suspects; cette troisième catégorie cherche à combiner les avantages de chacune, en se reposant sur des spécifications élaborées par l'opérateur ainsi que sur des contraintes qui caractérisent le bon fonctionnement du réseau.
Les écarts au profil normal spécifié permettent de détecter les attaques en identifiant leur effet, tandis que les contraintes fixées par ces spécifications entraînent la détection de comportement individuels malicieux.

Comme les spécifications sont réalisées par un opérateur humain (il ne s'agit pas d'un modèle généré par un algorithme), le taux de faux positifs est relativement faible.
En revanche, l'élaboration de ces spécifications peut s'avérer très complexe, et prendre beaucoup de temps.
Ces méthodes sont relativement peu implémentées dans la littérature.
%2}}}

\subsubsection{Des architectures adaptées}
%{{{2
Nous allons donner ici quelques exemples de propositions concrètes de systèmes de détection d'intrusion, sans chercher à couvrir l'ensemble des nombreuses catégories présentées.
La plupart d'entre elles se basent sur l'emploi d'architectures (clusterisation, architectures de sécurité) ou de protocoles (routage) déjà existants, auxquelles elles rajoutent des systèmes dédiés à la détection des attaques.

\paragraph{Quelques IDS pour réseaux clusterisés}
Le système SecCBSN (\textit{Secure Communications of Cluster-Based Sensor Network}, « communications sécurisées des réseaux de capteurs clusterisés ») introduit une architecture de sécurité à laquelle est adjointe un système de détection d'intrusion pour sécuriser au mieux possible les réseaux clusterisés~\cite{HHC07}.
Chaque nœud implémente trois modules: l'un intervient pour l'élection du \ch, réalisée sur le modèle de \leach.
Le deuxième module est chargé d'apporter authentification et chiffrement pour les communications entre les capteurs au sein du réseau, et utilise notamment une version retouchée du certificat TESLA.
Ajout notable par rapport aux architectures que nous avions vues jusque là, un troisième module module est chargé de la détection des nœuds compromis.
Lorsqu'il détecte des comportements anormaux de la part de nœuds donnés, ce module fait propager une alarme jusqu'à la station de base pour l'informer de l'état malicieux de ces capteurs.
Ce module se base sur un ensemble assez complexe de règles permettant de vérifier à la fois le bon comportement (non compromission) et le bon fonctionnement (disponibilité) des nœuds voisins.
Le système dans son ensemble est finalement proche des mécanismes que nous utilisons, sauf que tous les capteurs réalisent une activité de surveillance.

Notre système en question repose sur les travaux de \textsc{Lai} et \textsc{Chen}, qui ont proposé en 2008 une solution proche mais dont seuls certains capteurs effectuent des opérations de surveillance~\cite{LC08}.
Ces nœuds de contrôle, appelés \textit{gNodes} (pour \textit{guarding nodes}) par leurs auteurs, sont sélectionnés au sein du cluster pour effectuer les opérations de surveillance, permettant ainsi aux autres nœuds d'économiser d'autant en énergie.
Lorsque le \ch reçoit plusieurs rapports de la part de \textit{gNodes} distincts (ceci afin de limiter les cas de faux positifs), le \CH en vient à considérer le capteur dénoncé comme étant corrompu et prend des mesures en conséquences.
Bien que les simulations menées fournissent de bons résultats en termes de préservation des ressources, l'étude ne se penche pas sur le processus utilisé pour la désignation des nœuds de contrôle, et ne traite pas de leur renouvellement dans le temps, ce qui fait que les même capteurs supportent la tâche de surveillance sur de longues durées.

C'est sur ces points que se concentrent la majeure partie des travaux présentés dans cette thèse: les \cns que nous utilisons ne sont qu'une version renommée des \textit{gNodes}, pour lesquels a été proposé dans un premier temps un renouvellement périodique~\cite{GMT12}.
Nous nous attachons, dans le choix des nœuds de surveillance, à répartir au mieux la consommation énergétique dans le cluster; d'autres études cherchent à désigner ces nœuds de manière à obtenir la meilleure couverture possible, et à maximiser les chances de détection des nœuds compromis à l'aide d'heuristiques pour le placement de l'IDS~\cite{INK09}.

\paragraph{Lutter contre les pertes de paquets}
À travers l'usage plus ou moins direct de systèmes de détection d'intrusions, plusieurs architectures déjà établies ont été adaptées dans le but de faciliter la détection de nœuds corrompus au sein du réseau.

OLSR (\textit{Optimized Link State Routing protocol}) est l'un des protocoles de routages souvent déployés dans les réseaux de capteurs.
Une nouvelle version de ce protocole, appelée DLSR~\cite{MKASF10}, a été proposée en vue de reprendre ses fonctionnalités tout en ajoutant des mécanismes de détection contre les attaques de déni de service distribuées.
Lorsque la station de base reçoit un trafic trop important, qui menace de saturer sa capacité de traitement ou bien qui crée de trop fortes congestions sur ses liens, elle envoie un signal dans tout le réseau en vue de prévenir les nœuds; le trafic est alors analysé, par chaque nœud relais, par un automate d'apprentissage afin de détecter et supprimer les paquets malveillants.
DLSR fait signaler par la station de base la fin de l'attaque, afin que les nœuds cessent les opérations nécessaires au filtrage des paquets.

Basé sur des mécanismes simples, REWARD reprend la règle de retransmission pour assurer qu'aucun nœud ne commet d'attaque de type \textit{blackhole}~\cite{Kar05}.
À chaque émission de paquet, le nœud émetteur (qu'il soit émetteur d'origine ou relais, sauf s'il est le dernier relais de la route empruntée) vérifie que le destinataire retransmet le paquet sur le saut suivant.
Cette procédure ne permet pas de détecter deux attaquants « alignés » sur la route des paquets, qui agiraient de concert, le premier transmettant le paquet au second, sans lever d'alerte lorsque celui-ci se contenterait de supprimer le paquet.
Aussi lorsque l'on suspecte une attaque de ce type d'avoir lieu, REWARD ne se contente plus de ne faire surveiller que ses voisins directs par un capteur, mais propose d'augmenter la puissance de transmission lors du transit du paquet, de sorte que la règle puisse être vérifiée par chaque nœud sur les deux sauts suivant son émission.

Une conséquence des attaques de type \textit{sinkhole}, outre la perte des paquets, est la consommation supplémentaire en énergie que l'attaquant impose à ses voisins.
Une étude se base sur ce constat pour établir une méthode « géostatistique » de détection pour ces attaques~\cite{SKDM14}.
Le principe consiste à échantillonner périodiquement des zones du réseau, en demandant aux nœuds leur énergie résiduelle.
Un traitement sur ces données permet de déterminer les zones ou l'énergie des nœuds est plus faible qu'elle ne le devrait, et donc où une attaque de type \textit{sinkhole} est peut-être en cours.
Ce traitement consiste en l'application d'un modèle de survie, plus précisément une régression de C\textsc{ox} (modèle à risque proportionnel), qui est réalisé soit par la station de base, soit, dans une version adaptée, par des nœuds de confiance au sein du réseau.

\paragraph{Sécurité système}
Outre les systèmes de détection d'intrusion machine, qui opèrent sur le système d'exploitation du nœud même sur lequel ils s'exécutent, il est possible de faire vérifier l'intégrité des systèmes par d'autres entités.
Il existe ainsi une proposition concernant l'usage d'agents mobiles dans le réseau, qui se déplacent de nœud en nœud pour vérifier que le code binaire de leur système n'a pas été altéré~\cite{HR13}.
Si des capteurs corrompus sont détectés et que leur état ne peut être immédiatement restauré (soit que l'opération soit impossible, soit que l'agent mobile reçoive l'alarme d'un autre capteur et n'ait pas encore eu le temps d'accéder au nœud affecté), ces agents permettent également de propager l'alerte dans le réseau.

\paragraph{}
Plusieurs études se proposent de résumer les avancées des solutions proposées en termes de systèmes de détection d'intrusion~\cite{ME13,MS14}, et fournissent de nombreux autres exemples de ces systèmes.
Les travaux de synthèse récents de \textsc{Butun, Morgera} et \textsc{Sankar}, qui classent et détaillent les IDS pour MANET (\textit{Mobile Ad hoc Networks}, \textit{réseaux ad hoc mobiles}) et réseaux de capteurs sans fil~\cite{BMS13} sont notamment très complets.
%2}}}
%1}}}

\subsection{Rétablir le fonctionnement normal}
%{{{1

Inscrire les nœuds corrompus sur une liste noire n'est pas nécessairement la seule réponse possible.
Une étude propose, pour un réseau dont les capteurs ne seraient pas trop difficiles d'accès, l'usage d'agents mobiles pour récupérer au mieux d'attaques de déni de service « sur les chemins »~\cite{LB09}.
Ces attaques consistent à compromettre plusieurs nœuds, qui a leur tour mènent des attaques par déluge de paquets dans le but de créer des congestions et d'épuiser la batterie de tous leurs voisins, allant ainsi jusqu'à créer de grands espaces vides dans le réseau.
La solution proposée repose sur l'usage d'entités mobiles qui sont capables de se déplacer dans le réseau pour rétablir le statut initial des capteurs et si possible récupérer le contenu de leur base de données.
Mais ce déplacement prend du temps: si moins de 15~\% des capteurs sont suspects, il est envisageable de laisser les agents mobiles tourner dans le réseau pour restaurer leur configuration d'origine.
Les nœuds suspects ne sont pas exclus, ce qui limite le risque de faux positifs.
Lorsque le taux de capteurs suspects est évalué entre 15~\% et 60~\%, une liste noire est créée pour limiter les dégâts infligés nœuds légitimes le temps que les agents mobiles puissent d'agir.
Enfin, lorsque le seuil critique de 60~\% est dépassé, les agents mobiles s'appliquent avant tout à restaurer l'image mémoire et logicielle des nœuds jugés les plus essentiels au bon fonctionnement du réseau sur des capteurs encore en état de marche, et à entretenir ces derniers.

Notion de confiance
Many consist in the implementation of trust based mechanisms\cite{MC10,F-GRL07} 


%1}}}
