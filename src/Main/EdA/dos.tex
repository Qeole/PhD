% vim: set spelllang=fr foldmethod=marker:
\section{Déni de service}\label{ea:sec:dos}
%{{{1
%{{{2

Une attaque dite de « déni de service » menée dans un réseau informatique est une attaque réalisée dans le but de nuire au fonctionnement normal de ce réseau.
Il existe de très nombreuses façons de procéder, et on recense par conséquent une multitude d'attaques par déni de service existantes.
L'état de l'art dans ce domaine (et à propos de la sécurité en général, par ailleurs) a ceci de particulier qu'il comporte deux points de vue: celui de l'attaquant et celui du « défenseur ».
Il est indispensable de pouvoir définir le modèle d'une attaque pour pouvoir proposer des contre-mesures adéquates.
Et de façon plus ou moins réciproque, les mécanismes de protection mis en place au fil du temps poussent les attaquants (ou les chercheurs) à développer de nouvelles attaques pour les contourner.

Les réseaux de capteurs se retrouvent malheureusement très exposés aux attaques de déni de service~\cite{RM11}, du fait de:
\begin{itemize}
    \item leurs ressources extrêmement limitées, et principalement en termes d'énergie;
    \item leurs faibles capacités, qui peuvent introduire des délais (latence dans les communications ou délai de traitement)
    \item leur exposition aux attaques physiques;
    \item la faible fiabilité du medium de transmission, en termes de confidentialité ou de collisions
    \item leur gestion réalisée à distance;
    \item l'absence d'une gestion centralisée (et l'impossibilité de connaître avec précision le statut des autres nœuds);
\end{itemize}

Dans cette section nous présenterons d'abord les principales attaques répertoriées dans les réseaux de capteurs, puis nous aborderons les mécanismes proposés en réponse dans la littérature.
Auparavant, nous allons voir qu'il existe plusieurs façons de classer ces attaques.
%2}}}
%1}}}

\subsection{Différentes classifications}
%{{{1

\subsubsection{Selon l'objectif recherché}
%{{{2
Une première façon de classer les attaques est de considérer l'objectif de l'attaquant.
Les buts principaux de ces attaques sont:
\begin{itemize}
    \item l'accaparement de ressources pour les besoins propres de l'attaquant, au détriment des autres agents du réseau (par exemple, monopolisation du canal de transmission pour l'envoi des données de l'attaquant exclusivement). Il s'agit de comportements « cupides » (\textit{greedy} en anglais);
    \item la réduction, voir l'annihilation de la capacité du réseau à assurer correctement les services pour lequel il a été déployé, afin de nuire aux exploitants de ce réseau. Cette nuisance peut s'exprimer par des pertes financières, par exemple lorsqu'une telle attaque est menée sur Internet contre un site de commerce en ligne; dans le cas des réseaux de capteurs sans fils, et notamment lorsqu'ils sont utilisés dans un cadre militaire, l'exploitant d'un réseau peut alors se voir priver de l'accès aux informations stratégiques que devaient récolter les capteurs. On parle le plus souvent d'attaques de type \textit{jamming} en anglais, qui se traduit selon le cas par « brouillage », « encombrement », mais d'autres attaques reposant sur la privation de sommeil des capteurs, ou bien leur destruction physique, peuvent aussi être réalisées dans cet objectif;
    \item plus rarement, l'induction en erreur de l'exploitant du réseau de capteurs. Pour ceci l'attaquant cherche à fausser les résultats collectés (changement d'environnement des capteurs) ou transmis (altération du contenu ou du volume de données transmises).
\end{itemize}
%2}}}

\subsubsection{Selon la situation de l'attaquant}
%{{{2
On distingue également les attaques selon la provenance de l'attaquant, à savoir s'il fait partie du réseau, et mène par exemple une attaque sur le protocole de routage employé, ou bien s'il agit depuis l'extérieur du réseau, depuis une machine qui n'est pas reconnue comme faisant partie du réseau de capteurs.
Ce deuxième cas peut être illustré par un attaquant qui chercherait à brouiller de manière globale toutes les fréquences radio utilisées par les capteurs pour communiquer.

Un attaquant extérieur n'a pas forcément connaissance de la façon dont fonctionne le réseau (architecture, protocoles employés, mesure de détection mises en place).
Il peut mener une attaque sans ces informations (cas du brouillage des fréquences par exemple), ou bien justement chercher à s'introduire dans le réseau.
Cette intrusion peut être réalisée par l'attaquant soit en faisant accepter l'un de ses appareils propre aux autres agents du réseau, soit en compromettant l'un des agents jusqu'alors légitime dans le réseau.
Une fois l'accès interne obtenu, il devient généralement beaucoup plus facile d'accéder à des informations sur le fonctionnement du réseau.
L'attaquant, en fonction des mesures mises en place, devient aussi susceptibles d'être détecté et exclu du réseau.
Les attaques menées depuis l'intérieur jouent souvent sur les paramètres des protocoles employés, et sont souvent plus « subtiles », plus délicates à détecter et identifier pour l'opérateur du réseau si aucune méthode de détection d'intrusion n'a été mise en place.
%2}}}

\subsubsection{Selon les capacités de l'attaquant}
%{{{2
On peut encore distinguer les attaques selon la puissance dont dispose l'attaquant, que ce soit en terme de calcul, d'émission électromagnétiques, ou bien d'alimentation en énergie.
Un attaquant peut n'avoir à disposition qu'un capteur normal (\textit{mote-class attacks} en anglais), qu'il lui appartienne ou bien qu'il ait été compromis parmi les capteurs déployés à l'origine.
Il se retrouve dans ce cas avec des machines similaires aux appareils attaqués, mais n'a pas besoin de rester sur place et peut mener des attaques sur la durée.
Il peut également être équipé d'un ordinateur plus puissant (\textit{laptop-class attacks}), voir de matériel militaire spécialisé.
Dans ce cas, il est plus aisé de déployer de la puissance (puisque l'attaquant peut s'affranchir des limites imposées par les batteries des capteurs) et par exemple de brouiller en continu toute une plage de fréquence.
Il faut néanmoins que le matériel utilisé reste déployé le temps de mener l'attaque, ce qui peut s'avérer coûteux sur la durée.
%2}}}

\subsubsection{Attaques actives, passives}
%{{{2
Cette méthode de classement ne s'applique pas ici.
Les attaques dites « passives » n'interfèrent pas avec le fonctionnement normal du réseau: il peut s'agir par exemple d'écoute clandestine en vue de collecter des données (atteinte à la confidentialité des communications), mais par définition les attaques de déni de service sont des attaques dites « actives », au cours desquelles l'attaquant introduit de nouveaux comportement dans le réseau.
%2}}}

\subsubsection{Selon le paradigme considéré}\label{ea:sss:paradigm}
%{{{2
Nous abordons à présent des méthodes effectives de classement, qui permettent de catégoriser plus précisément les attaques (plutôt que d'établir une simple dissociation des catégories sur un nombre restreint de critères).

Certaines études se penchent sur une classe d'opérations réalisées par les réseaux de capteurs, et répertorient les attaques et les contre-mesures qui s'appliquent à cette classe~\cite{JPD06,OX09}.
Les paradigmes suivants peuvent être considérés:
\begin{itemize}
    \item la collecte et la transmission simples des données (paradigme qui se concentre sur une collecte simple et un envoi direct à la station de base, sans traitement, sans routage dans le réseau);
    \item la transmission des données d'un point à un autre du réseau (\cad tout ce qui touche au routage des paquets dans le réseau, donc en faisant intervenir la retransmission des paquets par plusieurs nœuds intermédiaires);
    \item la réception et le traitement de commandes (dans le cas où les nœuds sont susceptibles de communiquer entre eux et de s'échanger des commandes, pouvant mener à des changement de configuration des capteurs);
    \item l'organisation autonome du réseau (les réseaux de capteurs s'organisent de façon autonome, mais des attaques peuvent chercher à interférer avec la formation d'une architecture cohérente; dans ce paradigme sont inclus les protocoles de clusterisation éventuellement mis en application);
    \item l'agrégation de données (qui consiste à agréger, éventuellement compresser les données reçues avant retransmission, dans le but de limiter la taille et le nombre de paquets envoyés, afin de minimiser l'utilisation du canal de transmission, et surtout la consommation en énergie des capteurs);
    \item l'optimisation du modèle utilisé (qui intervient lorsque les capteurs ont des décisions à prendre, basées sur le contenu des paquets, telles que la retransmission directe ou différée, le niveau de sécurité à fournir\dots).
\end{itemize}
Cette méthode de classement est la plus utile pour se concentrer sur un point particulier du fonctionnement d'un réseau, et relever toutes les failles susceptibles d'affecter les opérations concernées.

À noter qu'il existe dans la littérature des classifications ontologiques (le système est représenté sous forme de graphe relationnel) des attaques de déni de service~\cite{VS10}, qui se rapproche quelque peu de la méthode présentée ici, même si les exemples traités portent le plus souvent sur les réseaux en général sans évoquer les capteurs.

La \tabref{ea:tab:paradigm} située plus bas présente un classement selon les paradigmes des attaques que nous allons introduire.
%2}}}

\subsubsection{Selon les couches de protocoles concernées}
%{{{2
Une seconde méthode efficace de classement consiste à procéder par couches de protocoles, en se basant sur le modèle TCP/IP (schéma concret lui-même issu du modèle théorique OSI, de l'anglais \textit{Open Systems Interconnection}).
Ce modèle est rappelé en \figref{ea:fig:tcpip}.
\begin{table}[!ht]
    \centering
    \begin{tabular}{c |c| l}
        \multicolumn{2}{c}{} & Exemple:\\
        \cline{2-2}
        5 & Application & HTTP, FTP, SSH\\
        \cline{2-2}
        4 & Transport & TCP, UDP\\
        \cline{2-2}
        3 & Réseau & IP\\
        \cline{2-2}
        2 & Liaison & IEEE 802.11 (CDMA/CA)\\
        \cline{2-2}
        1 & Physique & ondes électromagnétiques\\
        \cline{2-2}
     \end{tabular}
    \medskip
    \caption{Modèle TCP/IP}\label{ea:fig:tcpip}
\end{table}

Ce classement permet une revue efficace, couche par couche, de la plupart des attaques connues.
C'est donc selon ce critère que nous allons maintenant présenter les principales attaques de déni de service connues dans les réseaux de capteurs.
%2}}}
%1}}}

\subsection{Différents types d'attaques}
%{{{1

    \subsubsection{Couche physique}
%{{{2
La couche physique du réseau correspond au medium physique employé pour la transmission des données entre deux nœuds, et à la façon dont le signal est transmis au travers de ce medium.
Dans le cas de réseaux sans fil, le signal est propagé sous forme d'ondes électromagnétiques qui se déplacent dans le vide (ou bien, sans en être affectées, à travers l'atmosphère).
Sauf s'il est fait usage d'une antenne directionnelle pour l'émission, ces ondes sont envoyées dans toutes les directions, et tout appareil à portée équipé d'un récepteur se retrouve donc en mesure de recevoir les paquets émis.

        \paragraph{Brouillage de fréquences}
Le brouillage de fréquences (\textit{frequency jamming} en anglais) consiste pour l'attaquant à émettre un signal parasite, un « bruit » électromagnétique, sur les fréquences concernées, de façon à ce que la cible visée ne puisse plus recevoir de façon correcte les paquets qui lui sont envoyés par les nœuds légitimes.
Le brouillage peut être réalisé à l'aide d'une antenne directionnelle pour viser une cible en particulier; mais dans le cas d'un réseau de capteurs, l'attaquant cherche en général à émettre un bruit dans toutes les directions afin d'affecter le plus grand nombre de nœuds possible.
L'attaque peut être menée de façon sporadique, de manière à produire un déni de service partiel, ou bien en continu.
Si la ou les machine(s) émettant le signal parasite possède(nt) une portée suffisante pour couvrir toute l'étendue géographique du réseau, l'intégralité des capteurs peuvent se retrouver dans l'impossibilité d'utiliser les fréquences brouillées.
Si de plus, le brouillage est mené sur toute la plage de fréquences accessibles aux capteurs, les communications deviennent totalement impossibles à établir dans le réseau.

Il est à noter que mener une telle attaque peut être coûteux en matériel pour l'attaquant, surtout s'il vise plusieurs fréquences et/ou un brouillage continu dans le temps.
Typiquement, un capteur corrompu ne sera pas en mesure de mener cette attaque sans épuiser très rapidement sa batterie.
%2}}}

    \subsubsection{Couche liaison de données}
%{{{2
La couche de liaison de données fournit les moyens fonctionnels et procéduraux pour le transfert des données entre deux entités du réseau.
Elle permet aussi, le plus souvent, de détecter et éventuellement corriger certaines erreurs survenues sur la couche physique (en cas de perturbation ou dégradation du signal électromagnétique).
Elle se décompose en deux sous-couches: la couche de contrôle de la liaison logique (LLC, pour \textit{Logical Link Control} en anglais) et la couche du contrôle d'accès au support (MAC, pour \textit{Media Access Control}).
C'est principalement cette seconde couche qui nous intéresse ici: le protocole de couche MAC définit la manière dont les différents agents du réseau accèdent au medium de transmission de façon à limiter les collisions, et à garantir un accès le plus souvent équivalent au medium pour tous les nœuds.
Les différents modes d'accès au medium existants sont résumés dans la \tabref{ea:tab:mac}; certains consistent à créer des canaux de transmission distincts, tandis que d'autres déterminent l'accès à une même bande de fréquence en instaurant des règles.
Ces règles peuvent être contournées, et la couche MAC va donc se retrouver associée à plusieurs types d'attaques.

\begin{table}[!ht]
    \caption{Méthodes d'accès au medium de transmission}\label{ea:tab:mac}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.2\textwidth}|m{.2\textwidth}|m{.48\textwidth}}
            \toprule
            \textbf{Nom anglais} & \textbf{Traduction} & \textbf{Description}\\
            \midrule
            \multicolumn{3}{c}{Commutation de circuits et création de canaux}\\
            \midrule
            \textit{Frequency Division Multiple Access} (FDMA) & Accès multiple par répartition en fréquence & Plusieurs canaux basés sur des fréquences différentes\\
            \midrule
            \textit{Code division multiple access} (CDMA) & Accès multiple par répartition en code & Étalement du spectre de fréquence utilisé en conjonction avec techniques comme les sauts de fréquences ou la génération de bruit pseudo-aléatoires (avec la même séquence pseudo-aléatoire appliquée au signal côté émetteur comme côté destinataire)\\
            \midrule
            \textit{Time division multiple access} (TDMA) & Accès multiple à répartition dans le temps & Un seul canal dont l'accès est réparti par créneaux dans le temps\\
            \midrule
            \textit{Space division multiple access} (SDMA) & Accès multiple à répartition dans l'espace & Plusieurs canaux spatiaux obtenus à l'aide d'antennes directionnelles. À noter: les antennes directionnelles augmentent sensiblement le coût de production des capteurs.\\
            \midrule
            \multicolumn{3}{c}{Mode d'accès par paquet}\\
            \midrule
            \textit{Contention based random multiple access methods} & Accès par contention & Contention par le nœud du paquet à envoyer jusqu'à ce que le protocole le lui autorise. Dans cette catégorie se trouve notamment le protocole CSMA/CA (\textit{Carrier Sense Multiple Access with Collision Avoidance}, accès multiple par écoute du canal avec esquive de collision), très utilisé dans les réseaux sans fil (IEEE~802.11 entre autres).\\
            \midrule
            \textit{Resource reservation (scheduled) packet-mode protocols} & Réservation des ressources & Réservation par un nœud des ressources (par exemple: créneau temporel) nécessaires à la transmission)\\
            \midrule
            \multicolumn{3}{p{.95\textwidth}}{D'autres modes d'accès par paquet (\textit{token passing, polling}) existent mais ne sont pas utilisés dans les réseaux de capteurs}\\
            \bottomrule
         \end{tabular}
     \end{small}
\end{table}

        \paragraph{Création de collisions et brouillage « intelligent »}
Lorsque plusieurs nœuds dont les portées se chevauchent émettent de façon simultanée en utilisant la même fréquence (donc sur un même canal), il se produit des collisions.
La plupart des protocoles MAC employés avec les réseaux de capteurs introduisent dans les trames un champ contenant une somme de contrôle, qui permet de vérifier l'intégrité de la trame.
Mais cette somme de contrôle ne permet pas, la plupart du temps, de corriger d'éventuelles erreurs (aucun des standards IEEE 802.11 (Wi-Fi), 802.15.1 (Bluetooth) ou 802.15.4 (ZigBee, 6LoWPAN) n'inclue de code de correction des erreurs).
Si un seul bit de la trame est altéré, celle-ci est donc rejetée par le destinataire.
Un attaquant peut donc chercher à produire des collisions en émettant un signal en même temps qu'un nœud légitime, afin que le destinataire ne puisse pas recevoir correctement la trame qui lui est destinée.
Ce principe de collision est identique au brouillage mené sur la couche physique; mais lorsque l'attaquant a connaissance du protocole de couche MAC employé, il lui est possible d'affiner son attaque, et de remplacer un brouillage « brut », continu et onéreux, par un brouillage « intelligent ».
Il existe plusieurs façons de procéder~\cite{PI11}:
\begin{itemize}
    \item la première, comme vu plus haut, n'est pas « intelligente » et consiste à brouiller les fréquences de manière continue, en produisant un bruit aléatoire;
    \item une technique plus difficile à détecter consiste à envoyer des paquets normaux mais de façon continue, de façon à occuper le canal sans interruption. Elle empêche les nœuds légitimes de transmettre dans le cas ou le protocole de couche MAC est CSMA/CA par exemple;
    \item une technique plus économe consiste à envoyer des bits à intervalles distincts (réguliers ou non), dans l'espoir de créer des collisions. Il n'est alors plus nécessaire d'émettre en continu, et l'attaque est moins facile à détecter. Elle est bien sûr moins efficace, car l'attaquant n'a plus la garantie de brouiller tous les paquets émis;
    \item les attaques « intelligentes » à proprement parler reposent sur la connaissance des spécifications du protocole MAC employé, et consistent à jouer sur la nature des paquets de contrôle et les délais d'attente. Ainsi, pour le protocole CSMA/CA employé avec la suite IEEE~802.11~\cite{ieee802.11}, une trame spécifique dite RTS (\textit{Request To Send} en anglais) de demande de réservation du canal est suivie d'une trame CTS (\textit{Clear To Send}) après une durée SIFS (\textit{Short InterFrame Space}) si le destinataire est prêt à recevoir des données. En créant une collision sur la seule trame CTS, l'attaquant prévient entièrement l'échange de données utiles entre les nœuds.
D'autres trames peuvent être utilisées dans le même but, leurs acronymes sont dans la \tabref{ea:tab:smartjam}.
\end{itemize}

\begin{table}[!ht]
    \caption{Brouillage « intelligent »: corruption des trames de contrôle}\label{ea:tab:smartjam}
    \centering
    \medskip
    \begin{tabular}{c c c}
        \toprule
        Paquet analysé & Temps d'attente & Paquet à corrompre\\
        \midrule
        RTS & SIFS & CTS\\
        DATA & SIFS & ACK\\
        RTS & DIFS & DATA\\
        Quelconque & DIFS & RTS ou DATA\\
        \bottomrule
    \end{tabular}
\end{table}

        \paragraph{Épuisement de la batterie}
Corrompre des trames à moindre coût permet à un attaquant de forcer une cible à émettre davantage de trames que prévu, puisqu'un échec de communication est généralement suivi de plusieurs autres tentatives.
À chaque nouvel essai, la cible doit émettre à nouveau la trame complète, et puise donc dans ses réserves énergétiques pour alimenter son bloc d'émission.
Étant donné qu'il est très difficile de changer la batterie d'un capteur une fois le réseau déployé, un capteur dont la batterie est vide cesse d'être opérationnel, et ne remplit plus du tout son rôle.
L'attaquant peut donc chercher à épuiser la batterie d'un ou de plusieurs nœuds à portée, soit en leur faisant émettre plus de trames que nécessaires (collisions), soit en les retenant le plus possible en état d'activité (émission ou écoute du canal) pour les empêcher de rentrer dans un état de veille qui permet l'économie des ressources (attaque par privation de sommeil).
Une autre méthode consiste encore à pousser la cible à mener des calculs intensifs: morsque des algorithmes cryptographiques sont mis en application notamment, chaque requête, même rejetée, se traduit par un nombre important de calculs nécessaires pour vérifier la signature d'un message.
Si l'attaquant se sert d'un capteur corrompu ou d'un appareil équivalent pour mener son attaque, il lui est essentiel d'émettre le moins de signaux possibles pour économiser son énergie, et ne pas vider sa batterie au même rythme que ses cibles (au risque de devenir inactif avant les nœuds visés).

        \paragraph{Accaparement du canal de transmission}
Un appareil compromis introduit dans le réseau peut chercher à s'octroyer un accès plus important que les agents légitimes au canal de transmission.
Ce comportement cupide (ou \textit{greedy} en anglais) peut être atteint par exemple en jouant sur les paramètres du protocole de couche MAC: non respect des durées minimales DIFS entre deux envois (pout IEEE~802.11 par exemple), non respect des valeurs employées pour la taille des fenêtres de congestion, non respect de la réservation des ressources par d'autres nœuds, \etc.
Le but final de telles attaques peut être d'envoyer plus de données à la station de base, dans le but par exemple de fausser une moyenne, ou bien de transmettre les données écoutées (attaque sur la confidentialité) dans le voisinage à une autre machine corrompue du réseau, en vue de l'exfiltration de ces données utiles capturées.

        \paragraph{Falsification d'accusés de réception}
La falsification d'un accusé de réception, à destination d'un nœud venant d'émettre des données, permet à un attaquant d'empêcher ce nœud de réaliser d'autres tentatives de transmission de la trame.
Elle n'est utile, bien entendu, que dans le cas où l'attaquant pense que l'émission de la trame d'origine a échoué, par exemple parce qu'il a créé une collision sur le canal lors de cette première émission.
C'est une attaque qui vient compléter les techniques de brouillage de façon à empêcher la transmission de l'information dans le réseau.
%2}}}

    \subsubsection{Couche réseau}
%{{{2
La couche réseau, pour les capteurs sans fils, repose le plus souvent sur le protocole IP (\textit{Internet Protocol} an anglais), que ce soit en version 4 ou 6 (la version 6 est notamment utilisée avec la pile 6LoWPAN), pour l'adressage, et sur un protocole de routage qui détermine comment les paquets sont retransmis saut après saut dans le réseau.
Dans le cas d'un réseau clusterisé, il arrive que tous les capteurs soient à portée directe de leur \ch, et que ce dernier soit en mesure d'atteindre directement la station de base.
Le routage est alors très simple.
Mais dans d'autres cas, il est nécessaire d'établir une structure pour le réseau permettant l'acheminement des paquets jusqu'à leur destinataire.
Un protocole de routage efficace doit minimiser les pertes de paquets ainsi que les coûts de retransmission et éviter la création de boucles dans le réseau.
À l'inverse, un attaquant peut tenter de mener une attaque par déni de service en gênant le plus possible l'acheminement de ces paquets.

        \paragraph{Trou noir (\textit{blackhole})}
Une attaque de type « trou noir » (ou \textit{blackhole} en anglais) consiste pour un nœud compromis à n'effectuer aucune retransmission des paquets qui lui sont envoyés.
Le nœud accuse réception du paquet auprès de l'émetteur, mais ne transmet jamais le paquet pour le prochain saut prévu pour ce paquet par le protocole de routage.
Toutes les routes qui passent par ce nœud compromis mènent donc à la suppression pure et simples des paquets en cours de transit.

        \paragraph{Retransmission sélective de paquets (trous gris (\textit{grey holes}), attaques « on/off » (\textit{on/off holes}))}
Là où une attaque de type « trou noir » supprime tous les paquets au lieu de les retransmettre, il est possible de ne retransmettre à la place qu'un sous-ensemble de paquets.
L'attaque devient plus difficile à détecter, puisque le nœud compromis retransmet tout de même des paquets de temps à autre.

Les attaques basées sur ce mécanisme sont dites à retransmission « on/off » (\textit{on/off holes} en anglais) lorsque la retransmission de tous les paquets est soit complètement assurée, soit complètement suspendue en alternant entre ces deux phases au fil du temps.
On parlera plutôt d'attaques de type « trou gris » (\textit{grey holes} en anglais) lorsque la retransmission est partielle mais constante dans le temps, qu'elle soit basée sur un mécanisme aléatoire (paquets supprimés au hasard plutôt que d'être retransmis) ou selon des règles (selon le contenu utile, ou selon l'expéditeur ou le destinataire par exemple).

        \paragraph{Falsification des informations de routage (accaparement du canal de transmission, création de boucles, \etc)}
Une attaque peut être menée dès le déploiement du réseau en transmettant de fausses informations lors de la mise en place des règles de routages.
Ces informations vont alors chercher à nuire au routage des paquets, en créant des boucles cycliques dans la structure de routage, en partitionnant le réseau, en attirant à tord le trafic vers un nœud corrompu (par exemple pour exploiter les données et porter une attaque sur la confidentialité) ou vers un nœud légitime (pour surcharger ses capacités de traitement)\dots

De telles attaques peuvent aussi être menées lorsqu'un protocole de clusterisation est mis en application, dans le but de gêner l'organisation structurelle du réseau (puisque la mise en place des clusters définit le plus souvent la façon dont les paquets seront routés dans le réseau).

Plusieurs autres attaques présentées ci-dessous reposent sur la falsification des informations de routage.

        \paragraph{Puits (\textit{sinkhole})}
Une attaque \textit{sinkhole} en anglais est la combinaison d'une attaque de type « trou noir » avec la diffusion de fausses informations de routage, en vue d'attirer le maximum de paquets possible vers le nœud attaquant.
Concrètement, un nœud corrompu peut se déclarer voisin direct de la station de base et annoncer une route de coût nul vers cette dernière.
Ses voisins vont estimer qu'il s'agit du plus court chemin pour acheminer les paquets jusqu'à la station de base, et vont transmettre l'information à leur tour.
Au final une part importante des routes créées, et en conséquence du trafic routé, va passer par ce nœud compromis, ce qui peut mener à des congestions dans le réseau.
Rentre alors en jeu l'attaque \textit{blackhole}, qui supprime tous les paquets reçus plutôt que de les retransmettre à leur destinataire légitime.

Il est à noter que la littérature inverse parfois, et même confond de temps en temps, la terminologie des attaques de type \textit{blackhole} et \textit{sinkhole}.
Les définitions présentées ici sont celles qui semblent revenir le plus couramment.
Par ailleurs, tous les « trous » ne font pas nécessairement référence à des pertes de paquets: des trous physiques, logiques ou sémantiques peuvent se former dès le déploiement du réseau~\cite{JSM13}, mais il s'agit d'un problème qui tient davantage de la sureté et de la résilience que de la sécurité.

        \paragraph{Trou de ver (\textit{wormhole})}
Lorsque deux agents ou plus du réseau sont compromis par un attaquant, il leur est possible de mener une attaque de type « trou de ver » (\textit{wormhole attack} en anglais).
Cette attaque consiste à capturer du trafic en un point donner du réseau pour le réinjecter en un autre point.
Il faut donc au moins deux agents complices, l'un qui capture et l'autre qui injecte le trafic, et qui communiquent l'un avec l'autre par le biais d'un canal auxiliaire généralement distinct des canaux légitimes utilisés sur le réseau (un tunnel, ou « trou de ver », qui donne son nom à l'attaque).
Il est intéressant, pour les nœuds menant l'attaque, de retransmettre par exemple les informations (de routage, notamment) provenant du voisinage de la station de base en un point éloigné du réseau, de façon à faire passer le tunnel pour une route de bonne qualité vers la station de base, puis de mener des attaques de retransmission sélective.
Ou plus simplement, l'injection en un autre point des paquets utilisés pour la découverte de routes lors de la mise en place de la structure de routage peut nuire grandement à l'organisation du réseau, et conduire un nœud légitime à imaginer des voisins virtuels qui sont en réalité absolument hors de sa portée d'émission.

        \paragraph{Déluge de paquets « hello » (\textit{“hello” flooding})}
Un mécanisme souvent mis en place dans les réseaux de capteurs est l'envoi de paquets de type « hello » pour découvrir quels sont les nœuds dans leur voisinage.
À la réception d'un tel paquet, les nœuds voisins émettent en réponse un paquet « hello-reply » indiquant au premier capteur qu'ils ont reçu le message.
Un attaquant, s'il dispose d'une machine plus puissante que la moyenne des capteurs, peut forger et envoyer des paquets « hello-reply » avec une portée supérieure à celle des capteurs, pour leur faire enregistrer des voisins qui sont en réalité bien au-delà de leur portée d'émission, et désorganiser complètement le routage de paquets dans le réseau.

        \paragraph{Altération des données}
Lorsqu'aucune vérification de l'intégrité des données n'est réalisée, un nœud relais corrompu peut, s'il a accès au contenu (en clair ou parce qu'il possède la clé pour déchiffrer), modifier ou retrancher des données du paquet à retransmettre.
Les données qui parviennent à l'exploitant du réseau sont alors erronées ou incomplètes.

        \paragraph{Attaque Sybil}
Le nom de l'attaque « Sybil » provient du titre du roman éponyme écrit par Flora Rheta \textsc{Schreiber}, publié en 1973 et racontant le traitement d'une patiente souffrant de multiples dédoublements de la personnalité.
L'attaque en elle-même consiste justement pour un agent corrompu à endosser l'identité de plusieurs nœuds dans le réseau.
Ce peut être l'identité:
\begin{itemize}
    \item inventée, de nœuds inexistants;
    \item de nœuds existants, mais distants du nœud corrompu;
    \item de nœuds détruits et virtuellement remplacés par le nœud corrompu.
\end{itemize}
Cette mascarade permet au nœud compromis de faire échouer d'éventuels schémas de résilience, par exemple lorsque le protocole de routage prévoit des routes « de secours » si les routes principales venaient à être coupées.
Des schémas de partition, de réplication, de distribution du stockage de l'information se retrouvent également affecter si des nœuds qui sont considérés comme distincts par les agents légitimes sont en fait simulés par un unique capteur compromis.
Le mécanisme peut également être utilisé dans le but d'intensifier d'autres attaques~\cite{NSSP04}, notamment:
\begin{itemize}
    \item l'altération des données finales récupérées par l'exploitant, en transmettant des données erronées en provenance d'un grand nombre de capteurs virtuels;
    \item l'exclusion de nœuds légitimes du réseau dans le cas où une solution de détection est mise en place (voir plus bas), en simulant un comportement irrégulier de la part de ces nœuds, ou en votant contre eux sous le couvert de plusieurs identités de façon à remporter ces votes;
    \item l'accaparement de ressources, en réservant des ressources (créneaux temporels pour l'accès au canal\dots) pour plusieurs nœuds virtuels, mais qui ne seront utilisées que par le seul capteur menant l'attaque.
\end{itemize}
De manière générale, en l'absence d'un système efficace d'authentification, les attaques reposant sur des techniques d'usurpation d'identité peuvent être très compliquées à détecter et à contrecarrer correctement.
%2}}}

    \subsubsection{Couche transport}
%{{{2
La couche transport gère les communications de bout en bout entre processus.
Les protocoles les plus fréquemment utilisés, TCP (\textit{Transmission Control Protocol}) et UDP (\textit{User Datagram Protocol}) assurent l'ordonnancement des paquets et permettent d'éviter les pertes, les doublons et la corruption des paquets.
Le protocole TCP permet en plus à deux entités de communiquer en mode connecté en établissant une session (début, fin et validation des échanges).
En raison des données de contrôle que ces protocoles impliquent, ils ne sont pas systématiquement implémentés dans les réseaux de capteurs (ils le sont parfois dans des versions allégées).

        \paragraph{Déluge de paquets SYN (ou équivalents) (\textit{SYN flooding})}
Les attaques par déni de service existant sur les réseaux classiques au niveau de la couche transport peuvent aussi être appliquées dans les réseaux de capteurs: par exemple, si le protocole TCP est utilisé dans le réseau, un attaquant peut inonder le réseau de paquets SYN utilisés pour initier des connexions entre deux nœuds.
Cette attaque requiert une machine plus puissante (surtout, avec une meilleure alimentation en énergie) qu'un capteur, mais permet à la fois de créer des congestions dans le réseau, et de saturer les capacités des capteurs en ouvrant un nombre trop grand de sessions TCP.

        \paragraph{Désynchronisation TCP (ou équivalents)}
Dans le même registre, un attaquant peut forger des demande de désynchronisation pour mettre fin à des sessions TCP établies entre deux entités légitimes.
Les échanges de ces sessions sont donc interrompus jusqu'au rétablissement d'une nouvelle connexion: ces connexions impliquent l'envoi de données de contrôle (elle s'effectue en trois temps, on parle de \textit{three-way handshake} en anglais) qui consomment une quantité d'énergie précieuse pour les capteurs.
%2}}}

    \subsubsection{Couche application}
%{{{2
La couche application implémente éventuellement l'application utilisée au niveau le plus haut par le réseau de capteur pour assurer un service en particulier.
Les protocoles utilisés sur cette couche dépendent donc totalement de l'objectif final du réseau, il n'y a pas ici de standard à proprement parler.
Certaines attaques sont néanmoins applicables au niveau applicatif.

        \paragraph{Données erronées}
Un nœud compromis peut envoyer des données en parfaite contradiction avec les valeurs physiques mesurées (voire même, il peut s'affranchir des mesures et ainsi économiser de l'énergie).
Les valeurs transmises au niveau application viendront alors fausser les résultats obtenus par l'exploitant du réseau.

        \paragraph{Déluge de paquets}
Suivant l'application mise en place, il peut être envisageable pour un attaquant d'inonder le réseau de données utiles, qu'elles aient été effectivement mesurées ou non, soit dans une tentative de fausser les résultats obtenus par la station de base en faisant des moyennes sur les valeurs rapportées par l'ensemble des capteurs, soit pour créer des congestions dans le réseau.

        \paragraph{Désynchronisation}
Si jamais le protocole utilisé sur la couche application induit la création de sessions en mode connecté (comme pour TCP sur la couche transport), des attaques de désynchronisation peuvent être menées par un attaquant en vue de briser ces sessions.
%2}}}

    \subsubsection{Hors modèle}
%{{{2
        \paragraph{Destruction physique des capteurs}
Les capteurs sont des appareils de petite taille déployés en nombre, et dont la production ne doit par conséquent pas être trop coûteuse.
Cela implique que les appareils sont relativement fragiles, et d'autant plus difficiles à sécuriser que le réseau est souvent déployé en extérieur, parfois en environnement hostile.
Un attaquant peut donc parfois accéder directement au capteur lui-même.
C'est l'une des manières de s'emparer d'un capteur pour le reprogrammer et introduire un agent corrompu dans le réseau (l'autre méthode reposant sur des failles logicielles, qui permettent parfois l'injection distante de code).
Mais sans s'embarrasser de les reprogrammer, l'attaquant peut aussi se contenter de détruire physiquement les capteurs, ce qui est encore le moyen le plus efficace de les empêcher de fournir les services pour lesquels ils ont été conçus.

        \paragraph{Altération des mesures}
Toujours en raison de leur exposition physique, les capteurs peuvent être manipulés par un attaquant pour mesurer des données.
Des engins munis de caméras peuvent ainsi voir leur objectif obstrué (par une couche de peinture par exemple); ou bien des capteurs chargés de mesurer la température d'un élément donné peuvent être déplacés, de sorte à ce que leur thermomètre ne soit plus en contact avec cet élément.
Les capteurs continuent dans ce cas à mesurer des valeurs et à les retransmettre jusqu'à la station de base, mais ces mesures elles-mêmes (et donc les résultats obtenus par l'exploitant) se retrouvent faussées dès le départ.

        \paragraph{}
Les tables~\ref{ea:tab:layer} et~\ref{ea:tab:paradigm} synthétisent le classement de ces différentes attaques, respectivement par couche du modèle TCP/IP et par paradigme considéré.
Toutes les attaques exposées dans cette sous-section ont été décrites à maintes reprises dans la littérature, et notamment réunies au travers de plusieurs études portant sur l'état de l'art de la sécurité dans les réseaux de capteurs~\cite{SSS11,RM11,AD14}
\begin{table}[!ht]
    \newcounter{LayerNumber}
    \setcounter{LayerNumber}{1}
    \newcommand\num[1]{\theLayerNumber.~#1\stepcounter{LayerNumber}}
    \caption{Classement des attaques par couche du modèle TCP/IP}\label{ea:tab:layer}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.21\textwidth}|p{.71\textwidth}}
            \toprule
            \textbf{Couche} & \textbf{Attaques possibles}\\
            \midrule
            \multirow{2}{*}{Hors modèle}%
                & \num{Destruction physique des capteurs}\\
                & \num{Altération des mesures}\\
            \midrule
            \multirow{1}{*}{Couche physique}%
                & \num{Brouillage de fréquences}\\
            \midrule
            \multirow{4}{*}{\parbox{.2\textwidth}{Couche liaison de données}}%
                & \num{Création de collisions, brouillage « intelligent »}\\
                & \num{Épuisement de la batterie}\\
                & \num{Accaparement du canal de transmission}\\
                & \num{Falsification d'accusés de réception}\\
            \midrule
            \multirow{8}{*}{Couche réseau}%
                & \num{Trou noir}\\
                & \num{Retransmission sélective de paquets (trous gris, attaques « on/off »)}\\
                & \num{Falsification des informations de routage (accaparement du canal, création de boucles, \etc)}\\
                & \num{Puits}\\
                & \num{Trou de ver}\\
                & \num{Déluge de paquets « hello »}\\
                & \num{Altération des données}\\
                & \num{Attaque Sybil}\\
            \midrule
            \multirow{2}{*}{Couche transport}%
                & \num{Déluge TCP (ou équivalents)}\\
                & \num{Désynchronisation TCP (ou équivalents)}\\
            \midrule
            \multirow{3}{*}{Couche application}%
                & \num{Données erronées}\\
                & \num{Déluge de paquets}\\
                & \num{Désynchronisation}\\
            \bottomrule
        \end{tabular}
    \end{small}
\end{table}
\begin{table}[!ht]
    \caption{Classement des attaques par paradigme (voir \sssref{ea:sss:paradigm})}\label{ea:tab:paradigm}
    \centering
    \medskip
    \begin{small}
        \begin{tabular}{m{.3\textwidth}|m{.62\textwidth}}
            \toprule
            \textbf{Paradigme} & \textbf{Attaques possibles}\\
            \midrule
            Collecte et transmission simples & Brouillage, création de collisions, destruction des capteurs, altération des mesures, altération des données (applicatif)\\
            \midrule
            Routage des données dans le réseau & Retransmission sélective, trous noirs, épuisement des ressources (batterie, congestion du réseau), altération des données (lors de la retransmission), accaparement du canal de transmission, attaques au niveau de la couche transport\\
            \midrule
            Réception et traitement de commandes & attaques précédentes, usurpation d'identité (et attaque Sybil) utilisée pour émettre de fausses commandes\\
            \midrule
            Organisation autonome du réseau & attaques précédentes, fausses informations de routage (boucles\dots), puits, trous de ver, déluge de paquets « hello »\\
            \midrule
            Agrégation de données & attaques précédentes, en particulier celles basées sur le rejeu de paquets émis ou capturés\\
            \midrule
            Optimisation des modèles & attaques précédentes\\
            \bottomrule
         \end{tabular}
     \end{small}
\end{table}

Il est bien sûr très difficile de prétendre à l'exhaustivité, et il existe d'autres attaques de déni de service applicables au réseaux de capteurs: certaines dépendent d'applications particulières ou sont introduites par des configurations spécifiques (mobilité des nœuds, structures spécifiques: grille, recherche de couverture maximale\dots).
D'autres n'ont sans doute pas encore été découvertes.
Les attaques que nous avons présentées regroupent néanmoins les principales menaces, en termes de déni de service, auxquelles peuvent faire face les réseaux de capteurs.
%2}}}
%1}}}

\subsection{Prévenir les attaques}
%{{{1

    \subsubsection{Authentification et problématiques similaires}
%{{{2

La sécurité est transversale à l'ensemble des domaines d'études en informatique, et la protection contre le déni de service\dots est elle-même liée aux autres problématiques de sécurité.
Il faut entendre par là que si des failles du système compromettant l'authentification des agents ou l'intégrité des données peuvent également être exploitées d'une façon ou d'une autre pour nuire au bon fonctionnement du réseau, alors l'attaque en question vient également se classer parmi les attaques de déni de service.

De manière plus concrète, assurer correctement l'authentification des nœuds du réseau empêchera un attaquant de mener des attaques basées sur l'usurpation de l'identité d'un autre nœud.
Les attaques par désynchronisation, ou la falsification d'accusés de réception par exemple, deviennent inapplicables.
Si des mécanismes permettant de limiter le rejeu de paquets capturés sont rajoutés, l'ampleur des attaques Sybil ainsi que des attaques par trou de ver se verront fortement réduites.
La protection de l'intégrité des données assure de son côté l'échec de toute tentative d'altération des valeurs transmises lors des opérations de routage.

Les mécanismes dédiés à la protection de l'authentification, de l'intégrité, ou contre le rejeu, présentés en \sref{ea:sec:secu}, sont donc également utiles pour protéger un réseau de capteurs de certaines attaques de déni de service.
On parle de mesures de prévention, dans le sens où il s'agit de méthodes mises en place pour empêcher une attaque de survenir.

%2}}}

    \subsubsection{Des protocoles de routage spécifiques}
%{{{2
Toujours dans le but de prévenir les attaques, il est possible d'utiliser des protocoles de routage spécifiquement étudiés pour limiter les risques.
Ainsi, le protocole de routage AODV (\textit{Ad hoc On-demand Distance Vector routing}), très utilisé dans les réseaux de capteurs, a fait l'objet de propositions destinées à améliorer sa résistance aux attaques de déni de service de type \textit{blackhole} et \textit{sinkhole}: une étude propose par exemple de faire vérifier par chaque nœud, lors de la création des routes, que ses voisins de deuxième degré sont bel et bien accessibles~\cite{DLA02}.
Ainsi chaque nœud $x$ ayant un voisin $n$ qui lui propose une route vers une destination donnée, $x$ demande à $n$ quel est le prochain saut $n+1$ sur cette route et tente de contacter ce nœud $n+1$ pour vérifier qu'il est effectivement accessible.
Si $n+1$ répond, alors $n$ est digne de confiance pour cette route; puisqu'il est digne de confiance, on admet qu'il pourra à son tour vérifier l'accessibilité du nœud $n+2$ à travers le saut annoncé par $n+1$, et ainsi de suite tout au long de la route empruntée pour les données.

Toujours pour parer aux attaques sur le routage, d'autres méthodes se basent sur des mécanismes de redondance et de résilience, pour faire en sorte que si l'une des routes se révèle défectueuse, d'autres exemplaires des paquets, envoyés par des routes distinctes, puissent attendre leur destination.
Des mécanismes tels que le partage de secret peuvent être utilisés à cette fin de redondance, pour limiter l'augmentation du volume de données envoyées~\cite{MMB13}.

%2}}}

    \subsubsection{Prévenir la compromission des capteurs}
%{{{2
        \paragraph{Compliquer l'accès aux capteurs}
%{{{3
Il est en fin de compte très difficile de cacher la localisation géographique d'un capteur à un attaquant déterminé.
Des mécanismes alliant clusterisation et usage de fausses sources pour les messages peuvent être employés afin de compliquer la tâche à l'attaquant~\cite{GK13}.
L'usage d'antennes directionnelles peut également complexifier la localisation des nœuds, mais n'est pas adapté à toutes les utilisations des réseaux de capteurs.
Au final, un attaquant correctement équipé pourra toujours trouver un capteur en procédant par triangulation du signal électromagnétique.

Il peut alors devenir intéressant de cacher à l'attaquant quels sont les nœuds qui représenteraient le plus d'intérêt pour lui.
Un exemple traité est le jeu des « chasseurs de panda »: des capteurs dispersés dans l'habitat naturel d'un panda suivent les déplacements de l'animal et les rapportent à une station de base.
Mais des braconniers recherchent l'animal et tentent d'utiliser les données du réseau en vue de le localiser plus facilement.
S'il est impossible de cacher le signal des capteurs et d'empêcher les attaquants d'accéder directement aux machines, il est en revanche possible de déployer des mécanismes pour empêcher les chasseurs de savoir quel est le capteur qui renvoie à un instant donné les informations sur la présence du panda dans son secteur.
Un mécanisme pour disséminer l'information, basé sur le modèle des épidémies, a ainsi été proposé dans cet exemple~\cite{KDA14}.
Si l'on se concentre uniquement sur le déni de service, il est tout à fait possible d'imaginer l'utilisation de techniques similaires afin de dissimuler à l'attaquant quels sont les nœuds à compromettre pour infliger un maximum de dégâts au bon fonctionnement du réseau.

Une autre approche possible~\cite{Ho10} est de considérer que tout capteur ayant cessé de donner des « signes de vie » pendant une période prolongée est devenu hors-service, et qu'à ce titre il n'est plus censé réintégrer le réseau à l'avenir.
Cette période est par exemple déterminée à l'aide d'un algorithme SPRT (\textit{Sequential Probability Radio Test}) qui calcule la durée au-delà de laquelle l'absence de signal devient anormal.
Si le nœud tentait malgré tout de reprendre son activité au-delà de la période, alors supposition est faite que le capteur a été retiré du réseau par un attaquant le temps de procéder à une modification de son code, et ce nœud se retrouve alors volontairement exclu du réseau par mesure de précaution.
%3}}}

        \paragraph{Durcir la sécurité logicielle}
%{{{3
Si un attaquant parvient à accéder physiquement à un capteur, il devient très compliqué de l'empêcher d'accéder au contenu de la mémoire de l'appareil, et/ou de le reprogrammer selon ses besoins.
Des méthodes de chiffrement de la mémoire (principalement pour la mémoire non volatile) existent, mais sont peu implémentés sur les capteurs, car ils augmentent significativement la consommation en ressources de la machine et diminuent ses performances.
Des modifications malveillantes du code exécuté par un nœud peuvent parfois être détectées, comme nous le verrons lorsque nous traiterons des systèmes de détection d'intrusion machine en \sssref{ea:sss:hids}.

Mais outre les accès physiques directs, un attaquant peut très bien tenter de compromettre à distance un capteur, en exploitant des failles logicielles.
Des injections de code ont déjà été menées avec succès sur des capteurs, en utilisant par exemple des dépassements de tampons pour injecter une fausse pile d'exécution et mener une attaque dite \textit{return-into-libc}~\cite{FC08}.
La sécurité logicielle des capteurs doit donc être vérifiées avant même le déploiement du réseau.
Les bonnes pratiques d'ordre générale en sécurité s'appliquent ici comme ailleurs: de bonne pratique de développement pour le système sont indispensables, de même que la désactivation des services non utilisés (qui de toute façon consommeraient inutilement de l'énergie).
La sécurité du système peut éventuellement être spécifiquement renforcée, comme par exemple avec grsecurity pour des systèmes basés sur Linux~\cite{GFN11}.
%3}}}
%2}}}
%1}}}

\subsection{Détecter puis déjouer les attaques}
%{{{1

Les architectures de sécurité plus complexes traitées en \sssref{ea:sss:archi} introduises par ailleurs des mécanismes qui sont fréquemment réutilisés dans d'autres solutions qui visent également à prévenir les attaques de déni de service.
%{{{3
OLSR (\textit{Optimized Link State Routing protocol}) est l'un des protocoles de routages souvent déployé dans les réseaux de capteurs.
Une nouvelle version de ce protocole, appelée DLSR~\cite{MKASF10}, a été proposée en vue de reprendre ses fonctionnalités tout en ajoutant des mécanismes de détection contre les attaques de déni de service distribuées.
Lorsque la station de base reçoit un trafic trop important, qui menace de saturer sa capacité de traitement ou bien qui crée de trop fortes congestions sur ses liens, elle envoie un signal dans tout le réseau en vue de prévenir les nœuds; le trafic est alors analysé, par chaque nœud-relais, par un automate d'apprentissage afin de détecter et supprimer les paquets malveillants.
DLSR fait signaler par la station de base la fin de l'attaque, afin que les nœuds cessent les opérations nécessaires au filtrage des paquets.
%3}}}
%{{{3
% ======== >>> §2 <<<
%\subsection{[LO07] -- Modifié}
%% OLD VERSION
%Hierarchical sensor networks where clusters are formed dynamically and periodically using the LEACH algorithm, allow to distribute the energy load among sensor nodes.
%The problem of adding security to this type of network is raised by \textit{Oliveira et al}
%\cite{LO07}
%who propose SecLEACH which is a revised version of LEACH.
%It applies random key pre-distribution and $\mu$TESLA.
%They can be used both to secure communications in a hierarchical network with dynamic cluster establishment.

%% SecLEACH -- On the security of clustered sensor networks
A sensor network may be recursively and periodically reclustered with an algorithm such as \leach, as in our proposal.
The resulting hierarchically clustered network often presents a good ability for distributing the energy consumption among the sensor nodes.
But security concerns (other than DoS) also apply to those networks.
In~\cite{OFVWBDL07}, the authors propose to add security mechanisms \via a revised version of \leach protocol.
\textit{SecLEACH}\ uses random key pre-distribution as well as $\mu$TESLA (authenticated broadcast) so as to protect communications.
But the authors do not mention any mechanism to fight DoS attacks.
%3}}}


REWARD

\subsubsection{HIDS}\label{ea:sss:hids}
Some researchers prefer to ensure that nodes are not physically withdrawn from the network to get modified\cite{Ho10}, considering any returning node as compromised (but not detecting nodes modified on site), or to verify by means of mobile agents that the binary code run by the nodes has not been modified\cite{HR13}, although this solution makes use of cryptography mechanisms and can limit the evolution of the network.


\cite{HI12}

Many other systems, often more convenient to deploy, consist in the implementation of trust based mechanisms\cite{MC10,F-GRL07} with agents applying set of rules\cite{RKKK13} on traffic to attribute a trust value to each of the nodes in the network.
Each enforced rule is expected to protect the network against one kind of attacks: intruders are detected on breaking the rules.
We are particularly interested in the solution of Lai and Chen\cite{LC08} who proposed to elect control nodes to monitor the traffic in clustered networks so as to detect and react to \dos attacks.
In such a scheme, clustered networks are partitioned into clusters \via algorithms such as \leach\cite{HHT02} or VSR\cite{TV08}.


%{{{3
% ======== >>> §2 <<<
%\subsection{[LB09] -- Modifié}

%% Using mobile agents to recover from node and database compromise in path-based DoS attacks in wireless sensor network
\textit{Li} and \textit{Batten} expose in
\cite{LB09}
their method to detect and to recover from Path-based DoS (PDoS) attacks in wireless sensor networks.
They consider WSNs whose aim is to collect data and to store it into small databases.
PDoS attacks may prevent legitimate communication, lead the sensors to battery exhaustion and corrupt the gathered data.
So the authors introduce the use of Mobile Agents (MAs), which use hash function values, node IDs and traffic table to analyze the traffic and identify compromised sensors.
Thus the MAs are able to detect PDoS attacks with ease and efficiency, and to reply to the attack by proceeding to a recovery process.
There are three distinct recovery processes available, depending on the percentage of compromised nodes in the network.
Note that the authors use the assumption that MAs can not be compromised.

%% OLD VERSION
%A new detection and recovery method for compromised nodes in Path-based DoS (PDoS) attacks in wireless sensor network is presented in \cite{LB09} by \textit{Li} and \textit{Batten}. In this paper, the authors consider WSNs designed to collect and to store data in which path-based attacks can be carried on both the sensor nodes and the database containing the collected data. The contribution of this paper is the use of mobile agents (MAs) for the attack detection and the recovery process. The MAs detect PDoS attacks easily and efficiently. The solution is based on the use of hash function values, node IDs and traffic tables. By analyzing the traffic, the MA can detect the abnormal traffic and can designate the compromised nodes.
%% Using mobile agents to recover from node and database compromise in path-based DoS attacks in wireless sensor network
In~\cite{LB09} is described a method to detect and to recover from Path-based DoS (PDoS) attacks in wireless sensor networks.
The authors consider WSNs whose aim is to collect data and to store it into small databases.
PDoS attacks may prevent legitimate communication, lead the sensors to battery exhaustion and corrupt the gathered data.
Thus the use of Mobile Agents (MAs) is introduced: they use hash function values, node IDs and traffic table to analyze the traffic and identify compromised sensors.
In this way the MAs are able to detect PDoS attacks with ease and efficiency, and to reply to the attack by proceeding to a recovery process.
There are three distinct recovery processes available, depending on the percentage of compromised nodes in the network.
Note that the authors use the assumption that MAs can not be compromised.
%3}}}

%{{{3
% ======== >>> §5 <<<
%\subsection{[MH07] -- Modifié}

%% Adaptive security design with malicious node detection in cluster-based sensor networks
%% OLD VERSION
%An adaptive security design (SecCBSN) to secure cluster-based communication in sensor networks, is proposed by \textit{Hsieh et al.} in
%\cite{MH07}.
%It consists of three modules, which can detect malicious nodes by providing secure communication and authentication protocols between nodes.
%In each cluster, a CH schedules transmission and monitors periods for its sensor nodes.
%The primary security module uses the TESLA certificate (TCert) to enable existing nodes to authenticate new incoming nodes, triggering the establishment of secure links and broadcast authentication between neighboring nodes.
%In SecCBSN, the intrusion detection module prevents against compromised nodes.
%It uses alarm return protocols, trust value evaluation, and the propagation of black and white lists of nodes.

%% Adaptive security design with malicious node detection in cluster-based sensor networks
Sensors authentication and DoS detection in clustered networks may be assumed by a single architecture.
SecCBSN is described in~\cite{HHC07}.
It is an adaptive security design intended to Secure Cluster-Based Communication in Sensor Networks.
Each node is equipped with a system that includes three modules.
One is involved in the cluster head election, and responsible for remembering the decision which were made.
Another module provides ciphered communication and secure authentication protocols between sensors.
It uses the TESLA certificate to enable deployed sensors to authenticate new incoming nodes.
It allows the creation of secure channels as well as broadcast authentication between neighboring sensors.
The last security module is responsible for the detection of compromised nodes.
When a node is suspected to harm the network, alarm protocols are used to warn the base station.
The use of trust value evaluation then enables the setting and the propagation of black and white lists of sensors.
%3}}}


Many consist in the implementation of trust based mechanisms\cite{MC10,F-GRL07} with agents applying set of rules\cite{RKKK13} on traffic to attribute a trust value to each of the nodes in the network.

%{{{3
In particular, Lai and Chen\cite{LC08} proposed to elect control nodes to monitor the traffic in clustered networks and to detect and react to \dos attacks.
%%%%%%%%%%%%%%%%%%%================================================
% Detecting Denial of Service Attacks in Sensor Networks
%\subsection{[LC08] -- Inchangé}

%\subsubsection{Ancienne version}
%A cluster-based intrusion detection system is proposed in
%\cite{LC08}.
%It prevents sensor networks from DoS attacks.
%This solution deploys a set of special nodes called ``guarding nodes'' (gNodes) which observe, analyze the network traffic and report DoS attacks to their cluster head if an abnormal event happens.
%In each cluster there are three types of nodes, gNode, cluster head and sensor node.
%Any kind of nodes may be compromised.
%In this study, the detection approach for diverse attack types and the actions taken after detection are explored for the different node types.

%\subsubsection{Version Camera-Ready}
In
\cite{LC08},
the authors propose a system detection based on static election of a set of special nodes called ``guarding nodes'' which analyze the network traffic.
When detecting abnormal traffic from a given node, ``guarding nodes'' identify it as a compromised node and they inform the cluster head of it.
In this study, the authors show the benefit of their method by presenting numerical analysis of detection rate but they don't consider the energy of the elected node which dies very quickly.


%% Detecting denial of service attacks in sensor networks
Much of our work relies on the work of Lai and Chen who proposed in~\cite{LC08} a system detection based on static election of a set of nodes called ``guarding nodes'' which analyze traffic in a clustered network.
When detecting abnormal traffic from a given node, ``guarding nodes'' ---~we call them \cns~--- identify it as a compromised node and inform the \ch of it.
On reception of reports from several distinct \cns (to prevent false denunciation from a compromised node), the \CH virtually excludes the suspicious node from the cluster.
The authors show the benefit of their method by presenting numerical analysis of detection rate.
Although the method is efficient for detecting rogue nodes, the authors do not give details of the election mechanism to choose the \cns.
Also, there is no mention in their study of renewing the election in time, which causes the appointed \cns to endorse a heavier energy consumption on a long period.

[ Rules; Watch dogs -> + clustering = guarding nodes ]
%3}}}

In a first attempt to bring load balancing to this solution, we propose in other papers\cite{GMT12,BMM13} to reiterate the election periodically.
Simulations show a better load repartition among the cluster, but at this time our focus was not on designing an energy efficient election process for the \cns.

We have observed in previous studies that renewing periodically the selection process of those monitoring nodes (\cns) helps saving energy in the network~\cite{BMM13}, and we have tried ever since to find an optimal selection algorithm to obtain a good equilibrium between security, attack detection and energy preservation~\cite{MMB14}.

%{{{3
% ======== >>> §4 <<<
%\subsection{[HI09] -- Modifié}

%% Optimal Sensor Placement for Detection against Distributed Denial of Service Attacks
The best way to detect for sure a DoS attack in a WSN is simply to run a detection mechanism on each single sensor.
Of course, this solution is not feasible in a network with constraints.
Instead of fitting out each sensor with such mechanism, \textit{Islam et al}. propose in
\cite{INK09}
to resort to heuristics in order to set a few nodes equipped with detection systems at critical spots in the network topology.
This optimized placement enables distributed detection of DoS attacks as well as reducing costs and processing overheads, since the number of required detectors is minimized.
But those few selected nodes are likely to run out of battery power much faster than normal nodes.

%% OLD VERSION
%The running of a detection mechanism on every node in the network allows achieving a perfect detection against DoS attacks but it is not a feasible solution in a constrained network.
%In
%\cite{HI09},
%an optimized placement of detection nodes in a network for distributed detection of DoS attacks is proposed.
%In addition to placing detection nodes at critical points in a network, this proposition minimizes the number of these required nodes and therefore reduces the cost and processing overheads.

%% Optimal Sensor Placement for Detection against Distributed Denial of Service Attacks
The best way to detect for sure a DoS attack in a WSN is simply to run a detection mechanism on each single sensor.
Of course, this solution is not feasible in a network with constraints.
Instead of fitting out each sensor with such mechanism, it is proposed in~\cite{INK09} to resort to heuristics in order to set a few nodes equipped with detection systems at critical spots in the network topology.
This optimized placement enables distributed detection of DoS attacks as well as reducing costs and processing overheads, since the number of required detectors is minimized.
But those few selected nodes are likely to run out of battery power much faster than normal nodes.
%3}}}



%1}}}
